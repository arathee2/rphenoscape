<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. RPhenoscape can be installed with the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the default build_opts will skip building the vignettes.</span>
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"phenoscape/rphenoscape"</span>, <span class="dt">build_opts=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-manual"</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
<p>The custom <code>build_opts</code> parameter ensures that the vignette(s) (such as this document) will be built and installed as well. (The default for <code>build_opts</code> will skip building vignettes.) Building vignettes requires a recent version of the knitr and rmarkdown packages. You can install these beforehand, or include the parameter <code>dependencies=TRUE</code> in the above. Note that the latter will also result in packages being installed that otherwise are only needed for <em>testing</em>, and for generating the help pages. If you don’t develop packages yourself, this may be much more than you need, and therefore installing knitr and rmarkdown beforehand is then the better option.</p>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via Ontotrace</h2>
<p>Use Ontotrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s Ontotrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code># A tibble: 15 x 5
   taxa      otu     otus       `anterior dentation… `anterior distal serr…
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;                     &lt;int&gt; &lt;chr&gt;                 
 1 Ameiurus… VTO_00… tb618637b…                    1 1                     
 2 Ameiurus… VTO_00… tb618637b…                    1 1                     
 3 Ameiurus… VTO_00… tb618637b…                   NA 1 and 0               
 4 Ameiurus… VTO_00… tb618637b…                   NA 1                     
 5 Ameiurus… VTO_00… tb618637b…                    1 1                     
 6 Ameiurus… VTO_00… tb618637b…                    1 1                     
 7 Ameiurus… VTO_00… tb618637b…                    1 1                     
 8 Ictaluru… VTO_00… tb618637b…                    1 1                     
 9 Ictaluru… VTO_00… tb618637b…                    0 1 and 0               
10 Ictaluru… VTO_00… tb618637b…                   NA 1                     
11 Ictaluru… VTO_00… tb618637b…                    0 1                     
12 Ictaluru… VTO_00… tb618637b…                    1 1                     
13 Ictaluru… VTO_00… tb618637b…                   NA 1                     
14 Ictaluru… VTO_00… tb618637b…                    1 1                     
15 Ictaluru… VTO_00… tb618637b…                    1 1                     </code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
2  VTO_0036220 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
3  VTO_0036275 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
4  VTO_0036276 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
5  VTO_0036278 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
6  VTO_0061495 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
7  VTO_0036218 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
8  VTO_0036225 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
9  VTO_0036277 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
10 VTO_0036272 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
11 VTO_0036274 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
12 VTO_0036223 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
13 VTO_0036273 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
14 VTO_0036221 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e
15 VTO_0061497 tb618637b-7911-40d0-b6ad-9bc6a4c29d3e

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code># A tibble: 1 x 2
  id                                                           label       
  &lt;chr&gt;                                                        &lt;chr&gt;       
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictal… Lundberg (1…</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree blocks, where: 
     block 1 contains NULL phylogenetic trees
     block 0 contains  phylogenetic trees 
     395 meta elements 
     1 character matrices 
     22 taxonomic units 
 Taxa:   Pylodictis olivaris, Ictalurus dugesii, Ameiurus platycephalus, Ameiurus catus, Ictalurus punctatus, Ameiurus natalis ... 

 NeXML generated by RNeXML using schema version: 0.9 
 size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_dacb627c-d099-4c6e-a423-93de88712595
2     Ameiurus catus otu_4ef58fbe-d529-4c13-84f8-51f05850df55
3     Ameiurus melas otu_f0e213c2-afdb-4ad7-9924-b7bbd6c17676
4   Ameiurus natalis otu_60a38e5c-0cf5-4abf-8934-44487d0e3e71
5 Ameiurus nebulosus otu_e4077291-47d0-4370-871e-7a556b080b20
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1      Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
2        Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
3   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
4           Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
5      Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
6         Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
7           Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
8         Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
9      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
10      Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
11 Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
12        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
13        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
14          Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
15      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
16       Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
17  Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
18         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
19   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
20      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
21     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
22       Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
                                        otu
1  otu_94c0bce5-2403-4629-8f08-175dec4b6cc5
2  otu_e3591647-0b24-49b6-bcfc-05e226cd4c31
3  otu_04749e11-cbbf-497f-ac3f-36d41a1d94b9
4  otu_4ef58fbe-d529-4c13-84f8-51f05850df55
5  otu_b48e7dc7-155f-4880-a82d-bfac9a04a497
6  otu_60a38e5c-0cf5-4abf-8934-44487d0e3e71
7  otu_f0e213c2-afdb-4ad7-9924-b7bbd6c17676
8  otu_de5dacf8-11d9-4323-872f-d581e1f7c0ec
9  otu_4669220b-5cba-4bbc-86cc-462c01813922
10 otu_b32a35e9-19dc-43bd-a4c5-1f9f831a09e9
11 otu_ccd176b9-adec-4663-8493-6c373d334209
12 otu_3220fd1c-5249-47a7-bd10-c7a53e853ca6
13 otu_46778a21-19e8-4cbb-bd0a-dee1c33a6165
14 otu_cc02a528-dfd9-49e6-ab63-57d07bf2e0a0
15 otu_e4077291-47d0-4370-871e-7a556b080b20
16 otu_dacb627c-d099-4c6e-a423-93de88712595
17 otu_7305b95c-636e-42ed-87b3-f417e76a36fa
18 otu_fb37109f-285d-47d7-89e3-ec41590d4e7e
19 otu_a38627aa-4152-4e60-b44c-ec204a170022
20 otu_9e766c7f-ad88-471e-b13f-6b6d77d9d96b
21 otu_62730529-9410-411f-a595-26af98c4c77b
22 otu_18094479-ecb3-4699-8e11-3e58b7990cdb
                                        otus
1  otus_89a14abd-c278-423a-9b24-e225fbab41c4
2  otus_89a14abd-c278-423a-9b24-e225fbab41c4
3  otus_89a14abd-c278-423a-9b24-e225fbab41c4
4  otus_89a14abd-c278-423a-9b24-e225fbab41c4
5  otus_89a14abd-c278-423a-9b24-e225fbab41c4
6  otus_89a14abd-c278-423a-9b24-e225fbab41c4
7  otus_89a14abd-c278-423a-9b24-e225fbab41c4
8  otus_89a14abd-c278-423a-9b24-e225fbab41c4
9  otus_89a14abd-c278-423a-9b24-e225fbab41c4
10 otus_89a14abd-c278-423a-9b24-e225fbab41c4
11 otus_89a14abd-c278-423a-9b24-e225fbab41c4
12 otus_89a14abd-c278-423a-9b24-e225fbab41c4
13 otus_89a14abd-c278-423a-9b24-e225fbab41c4
14 otus_89a14abd-c278-423a-9b24-e225fbab41c4
15 otus_89a14abd-c278-423a-9b24-e225fbab41c4
16 otus_89a14abd-c278-423a-9b24-e225fbab41c4
17 otus_89a14abd-c278-423a-9b24-e225fbab41c4
18 otus_89a14abd-c278-423a-9b24-e225fbab41c4
19 otus_89a14abd-c278-423a-9b24-e225fbab41c4
20 otus_89a14abd-c278-423a-9b24-e225fbab41c4
21 otus_89a14abd-c278-423a-9b24-e225fbab41c4
22 otus_89a14abd-c278-423a-9b24-e225fbab41c4

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_49545b99-30f7-42e4-857d-4313da6eb6cf
2   character_60a2e8b6-9d04-4457-b774-67855b20106c
3   character_0cddcffb-18e4-4f2b-8b62-0181a612c3d9
4   character_78de38ce-41db-402a-8514-86fb2e95026c
5   character_dde81e2f-4415-4a50-bce8-918ebe3f6424
6   character_7b94d0bf-490e-4391-b78a-e3542ee32c79
7   character_1c1e84a6-a008-4c64-841d-263fa361d8e5
8   character_2c5352df-7b91-451d-ab8c-baf51ae1ff89
9   character_a0b063be-17f3-4e1e-884e-e7b7c7553929
10  character_8fe5f008-5cae-4c3f-949e-5f5d17127a11
11  character_ac0e0354-6cac-4ba6-a12f-98eb4536343c
12  character_004e7c7c-c513-4c2b-8210-7baa5a7ee64c
13  character_fcd73d1f-e2ee-44b4-94dc-61338cd47d65
14  character_e0ca8fb5-a335-4d02-8b3e-66e9d6983a55
15  character_8df95be4-5864-4c5c-a07f-2c3a2dbc51d8
16  character_9d16c24d-639c-486e-a6f5-ed2595abd697
17  character_4f17546d-a75f-469e-b426-a2bf277f023d
18  character_717eceef-c732-43e8-9b9a-1ee6f86525cb
19  character_6d100907-f9fd-4e97-9692-3b28eb0d95ff
20  character_7409d1d5-e405-4e04-a6ad-56d4ad99ef66
21  character_1d067f79-e81a-4fe4-b1fa-3643dc9dddad
22  character_8c23788e-84a3-4af8-9524-344d1323906b
23  character_492eb720-8682-4523-8343-97f7a008b0b2
24  character_9de6bc3d-6cf7-423e-ab5d-3a8dc1c1c39c
25  character_e12670f5-802e-4f12-afd1-f38c65edfa53
26  character_c05e6102-457a-4748-87c0-57b508f07055
27  character_5fe96372-583f-4eab-8f31-46134dfe1616
28  character_19f235db-f1d7-4d12-9078-9fb11e260100
29  character_5adba7c2-2456-4403-8bb2-6cfa9c991776
30  character_b64c8812-b2e3-407b-bd12-5b9c0beeadae
31  character_baea960c-87d9-4dc2-a4a2-4fd01a6caa8c
32  character_da57ba19-8d3c-4260-956e-183cb048e719
33  character_c726fc74-8318-4fbf-8c7b-4c355fbb065a
34  character_0e41df2e-1b43-458c-84fa-0c92dc9714ef
35  character_f3646a2a-8557-4f5e-80e7-732cb2f56cd0
36  character_f4300aa4-e7d3-4204-a933-899e7b69e85f
37  character_0a4a12c6-54ca-47eb-9a06-f608eaee44bb
38  character_57d3ee31-f677-4d2d-a72f-a05b676523db
39  character_79d1067f-9af3-4250-959c-0233963b9130
40  character_83dc7296-c1d7-403f-8a38-4945a1b21e0b
41  character_c3757285-cd18-45f6-b8c9-db38cf53ada3
42  character_cc5442be-7e02-4993-a7cc-5e03dcc91fbd
43  character_67b6d50e-3bda-45ec-a64d-27bd3da4474f
44  character_23835f1a-1cf1-4a99-a0bd-4db50ba72747
45  character_61cb87d3-ce89-4370-822f-5a678fc5a7d8
46  character_0b5d64e3-1461-4b9b-ac61-8fbb6e21a2aa
47  character_df7242af-65bb-4492-82c5-9159f2e46904
48  character_d7abe908-14ed-471a-b46e-425c3565e272
49  character_3f88779e-7883-424c-ac7b-f2817fd6099c
50  character_a7eeb0f3-3822-415a-851e-6ce21a13cd37
51  character_2345fec6-89f0-4cfb-a967-2e2b16fd55d9
52  character_e4cf215f-7e5f-428e-9ba1-22f9f7cd5904
53  character_5e160af0-db05-4ec9-b414-f0b708a5790c
54  character_ab635dd6-e39f-4652-96ba-f0749c3ee630
55  character_9ef245e0-4019-4459-8788-a9c3293b094f
56  character_1ab1854c-aedc-4327-b834-b402edbfd15b
57  character_809ad3c1-51e0-4a63-9ef4-8213f634bc32
58  character_5909bb5b-4fdb-4bfa-8445-14ac419ec64e
59  character_5dbbd4ed-c04f-44fc-9987-6b53797d21f8
60  character_4261a8a9-6b80-4d58-9190-1b4e1153c14a
61  character_ce30493c-63fb-4e60-8e4b-32f4d6653b3e
62  character_a7b19f8e-f1ab-4768-8a7f-de8e86fdd5c3
63  character_32e46a9e-9cf8-4691-944d-5047205c9391
64  character_9cd20272-9f20-4ea9-b02c-a684c7cef09f
65  character_e424ec20-8342-474e-9282-807b30036a57
66  character_1c2324ca-2a29-48b0-8995-3c8d6e5caa68
67  character_6c4a9deb-5592-4dd6-aab5-f1748bc00f33
68  character_dc3d59d1-a04b-4682-b864-4a6b0c4dcd18
69  character_0a5cb629-13cc-4fb0-8e43-725758b739e4
70  character_fdeec977-49f4-44bc-8fed-a4e04adcb272
71  character_6ff378d2-ebe8-4768-b661-1a6ab33e307f
72  character_17e80e9c-b5fd-438e-80ec-69de84543b45
73  character_d420b993-02f2-4471-91b0-f78d4042c26e
74  character_c30d2285-3aad-47e9-b2f1-423273222155
75  character_e3d5cadc-1a47-47c8-9744-f0533eac3eb6
76  character_4497f756-99aa-49f8-9916-2f35abf2ed83
77  character_befc9057-1c75-4358-b472-812ec8a5de41
78  character_f64aa07c-911d-42f2-aeb4-a6797bb7eaba
79  character_5169aa95-9aa6-4167-8874-e77e1c441044
80  character_c0722ac3-e920-4078-a570-40183488b173
81  character_92cb4dc7-1102-4213-bc28-4d9ff57d6b30
82  character_c6312574-3e2a-40e7-8cde-131ca5f70b68
83  character_a9ad67c5-5924-4a11-9fa0-a123b60cb9ef
84  character_3a43e1f0-0252-42e3-86be-0c8628140fab
85  character_c6284653-955d-47c6-b88e-d438b5e67668
86  character_4f76ae16-5d56-4fd6-ac63-252a9e430f05
87  character_bc59fcf8-d734-47ee-be2d-b52d81455fb7
88  character_5c5a7657-cbd1-46f7-b84f-de2f72c0ee2b
89  character_e54e1b9c-1135-4085-89fe-126c7ff00888
90  character_7cc78689-ec23-461b-8464-1dc475a9ddaf
91  character_efcf328e-16a9-4439-a87c-851a0a9de581
92  character_dd08811f-6982-4918-ba6d-12bc4352f4d7
93  character_47412d2e-a944-4ff7-a144-80a177352183
94  character_78b1bc77-9f36-4dc4-9734-5e272f392711
95  character_1f440a0d-cc81-4806-970c-6c52bede7bc4
96  character_1e35dcd3-09a5-470e-886c-0f5ddc1280d6
97  character_b45e2790-4450-4ffc-a254-569c49887416
98  character_4c7958b9-25a0-49d7-bd73-e4c975a8caf2
99  character_356a5d41-7cfd-4464-ae1d-56e101fddee1
100 character_c99d2cb3-00ef-4ff4-8cdc-42b3d4722ac8
101 character_d94a7c83-0ff8-400a-8a68-905962e8b6cd
102 character_f174219f-8441-4829-b77f-6ddf48398114
103 character_c323adbe-feed-4eab-8088-be1cd5e2c3b9
104 character_663911a0-5c1b-42a0-853d-f7bc3d01afc9
105 character_abc05fa6-6f71-4ec2-a2a9-196b8c802fdd
106 character_a942e412-bb04-498e-ad34-8d051baa6eee
107 character_bbdd18e4-1006-4928-a64b-f79f0dfb7f4d
108 character_b34b19b5-e80e-4d72-a6f0-78449d738960
109 character_81153257-20fb-400f-885e-5b312b4dbd57
110 character_3a35383a-5881-448b-b1de-94479595ee3b
111 character_fd6df5fa-cff4-47b1-bdd7-1dc4ea9de779
112 character_57772d38-5652-411a-91e6-c9a5ef857579
113 character_0dd9263b-6ef7-47f6-b126-258e12377a2d
114 character_4eff3b0e-cb9e-4b31-91ad-3535bdd9892b
115 character_ce26e101-deb2-49dd-8cfa-c5bcf079dfa8</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code># A tibble: 15 x 5
   taxa      otu     otus       `anterior dentation… `anterior distal serr…
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;                     &lt;int&gt; &lt;chr&gt;                 
 1 Ameiurus… VTO_00… tb618637b…                    1 1                     
 2 Ameiurus… VTO_00… tb618637b…                    1 1                     
 3 Ameiurus… VTO_00… tb618637b…                   NA 1 and 0               
 4 Ameiurus… VTO_00… tb618637b…                   NA 1                     
 5 Ameiurus… VTO_00… tb618637b…                    1 1                     
 6 Ameiurus… VTO_00… tb618637b…                    1 1                     
 7 Ameiurus… VTO_00… tb618637b…                    1 1                     
 8 Ictaluru… VTO_00… tb618637b…                    1 1                     
 9 Ictaluru… VTO_00… tb618637b…                    0 1 and 0               
10 Ictaluru… VTO_00… tb618637b…                   NA 1                     
11 Ictaluru… VTO_00… tb618637b…                    0 1                     
12 Ictaluru… VTO_00… tb618637b…                    1 1                     
13 Ictaluru… VTO_00… tb618637b…                   NA 1                     
14 Ictaluru… VTO_00… tb618637b…                    1 1                     
15 Ictaluru… VTO_00… tb618637b…                    1 1                     </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code># A tibble: 8 x 5
  taxa     otu     otus        `anterior dentation … `anterior distal serr…
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;                       &lt;int&gt; &lt;chr&gt;                 
1 Ictalur… VTO_00… tb618637b-…                     1 1                     
2 Ictalur… VTO_00… tb618637b-…                     0 1 and 0               
3 Ictalur… VTO_00… tb618637b-…                    NA 1                     
4 Ictalur… VTO_00… tb618637b-…                     0 1                     
5 Ictalur… VTO_00… tb618637b-…                     1 1                     
6 Ictalur… VTO_00… tb618637b-…                    NA 1                     
7 Ictalur… VTO_00… tb618637b-…                     1 1                     
8 Ictalur… VTO_00… tb618637b-…                     1 1                     </code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code># A tibble: 1 x 5
  `@id`                label    extinct `rank.@id`               rank.label
  &lt;chr&gt;                &lt;chr&gt;    &lt;lgl&gt;   &lt;chr&gt;                    &lt;chr&gt;     
1 http://purl.obolibr… Coralli… FALSE   http://purl.obolibrary.… genus     </code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code># A tibble: 1 x 3
  label     definition                              `@id`                  
  &lt;chr&gt;     &lt;chr&gt;                                   &lt;chr&gt;                  
1 basihyal… Replacement bone that is median and is… http://purl.obolibrary…</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via Ontotrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the default build_opts will skip building the vignettes.</span>
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"phenoscape/rphenoscape"</span>, <span class="dt">build_opts=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-manual"</span>))</code></pre></div>
<p>The custom <code>build_opts</code> parameter ensures that the vignette(s) (such as this document) will be built and installed as well. (The default for <code>build_opts</code> will skip building vignettes.) Building vignettes requires a recent version of the knitr and rmarkdown packages. You can install these beforehand, or include the parameter <code>dependencies=TRUE</code> in the above. Note that the latter will also result in packages being installed that otherwise are only needed for <em>testing</em>, and for generating the help pages. If you don’t develop packages yourself, this may be much more than you need, and therefore installing knitr and rmarkdown beforehand is then the better option.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t14bacddf-15ea-405a-bd43-e153e1cc63a6
2  t14bacddf-15ea-405a-bd43-e153e1cc63a6
3  t14bacddf-15ea-405a-bd43-e153e1cc63a6
4  t14bacddf-15ea-405a-bd43-e153e1cc63a6
5  t14bacddf-15ea-405a-bd43-e153e1cc63a6
6  t14bacddf-15ea-405a-bd43-e153e1cc63a6
7  t14bacddf-15ea-405a-bd43-e153e1cc63a6
8  t14bacddf-15ea-405a-bd43-e153e1cc63a6
9  t14bacddf-15ea-405a-bd43-e153e1cc63a6
10 t14bacddf-15ea-405a-bd43-e153e1cc63a6
11 t14bacddf-15ea-405a-bd43-e153e1cc63a6
12 t14bacddf-15ea-405a-bd43-e153e1cc63a6
13 t14bacddf-15ea-405a-bd43-e153e1cc63a6
14 t14bacddf-15ea-405a-bd43-e153e1cc63a6
15 t14bacddf-15ea-405a-bd43-e153e1cc63a6
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 t14bacddf-15ea-405a-bd43-e153e1cc63a6
2  VTO_0036220 t14bacddf-15ea-405a-bd43-e153e1cc63a6
3  VTO_0036275 t14bacddf-15ea-405a-bd43-e153e1cc63a6
4  VTO_0036276 t14bacddf-15ea-405a-bd43-e153e1cc63a6
5  VTO_0036278 t14bacddf-15ea-405a-bd43-e153e1cc63a6
6  VTO_0061495 t14bacddf-15ea-405a-bd43-e153e1cc63a6
7  VTO_0036218 t14bacddf-15ea-405a-bd43-e153e1cc63a6
8  VTO_0036225 t14bacddf-15ea-405a-bd43-e153e1cc63a6
9  VTO_0036277 t14bacddf-15ea-405a-bd43-e153e1cc63a6
10 VTO_0036272 t14bacddf-15ea-405a-bd43-e153e1cc63a6
11 VTO_0036274 t14bacddf-15ea-405a-bd43-e153e1cc63a6
12 VTO_0036223 t14bacddf-15ea-405a-bd43-e153e1cc63a6
13 VTO_0036273 t14bacddf-15ea-405a-bd43-e153e1cc63a6
14 VTO_0036221 t14bacddf-15ea-405a-bd43-e153e1cc63a6
15 VTO_0061497 t14bacddf-15ea-405a-bd43-e153e1cc63a6

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Ictalurus furcatus, Ameiurus catus, Noturus flavus, Ameiurus platycephalus, Noturus stigmosus, Ictalurus balsanus ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_ebb59576-e273-4df3-9029-bff05e545c79
2     Ameiurus catus otu_3a056fd4-5e19-4b30-a956-db8f2f022582
3     Ameiurus melas otu_5b0f461e-aec4-4b2c-8d63-d0c0ec57f34c
4   Ameiurus natalis otu_62943de8-d1d6-4c18-a91e-bef389d3c80d
5 Ameiurus nebulosus otu_024f8e35-e98d-4e07-aa69-80f81f916ca5
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1       Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
2           Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
3           Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
4   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5        Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
6       Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
7    Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
8         Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
9         Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
10     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
11       Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
12        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
13        Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
14     Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
15      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
16     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
17         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
18     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
19  Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
20 Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
21       Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
22          Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
                                        otu
1  otu_5a7a597f-b490-4006-8223-771cf1a38fd7
2  otu_3a056fd4-5e19-4b30-a956-db8f2f022582
3  otu_44ec7806-1d04-4e5e-b3f9-159de6009817
4  otu_c7d7420c-ff6e-4bdc-979c-32709b331424
5  otu_7f2ead55-4906-485a-8cad-8d2ae3bf8ba9
6  otu_3844a4e9-f741-4637-b88c-bf55e569f05f
7  otu_dad1ed9c-b78f-4ca7-bc40-00b12541ce38
8  otu_62943de8-d1d6-4c18-a91e-bef389d3c80d
9  otu_67e9a4c4-8381-4395-94c4-0fbc0182a359
10 otu_123cd459-455d-4f99-b2a1-9451f7e3a0c5
11 otu_ebb59576-e273-4df3-9029-bff05e545c79
12 otu_9e56d888-c80a-4212-931f-422f45bcd1eb
13 otu_6566d04f-d9e1-4aa3-9bcb-a7745a3ec88a
14 otu_a1f2785a-6510-4454-8c90-2a69542ea2f6
15 otu_024f8e35-e98d-4e07-aa69-80f81f916ca5
16 otu_cc846cf3-eeac-4c8f-b954-a6a797cd0b87
17 otu_135f3dce-c70f-4f93-94cc-1514479f0602
18 otu_253405d1-4372-4036-bf86-50b45b4697d7
19 otu_d100a668-a36f-4769-816a-53e2aaf26d0b
20 otu_9a2782b7-3893-4eb4-9bbb-522d5dbb9649
21 otu_3e9014e5-40e3-45bf-a1fd-a687d9a2e829
22 otu_5b0f461e-aec4-4b2c-8d63-d0c0ec57f34c
                                        otus
1  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
2  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
3  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
4  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
5  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
6  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
7  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
8  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
9  otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
10 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
11 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
12 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
13 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
14 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
15 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
16 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
17 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
18 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
19 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
20 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
21 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5
22 otus_591fb6ad-fdeb-45f6-b208-6703c15779f5

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_09c2f4d9-e83f-4032-baf4-4dfe54fa73e6
2   character_86549a3e-9a02-4cfc-98d4-8265f7730e82
3   character_3402e4c9-414a-4085-9538-bafcd3bb72e0
4   character_9c9f3af4-ac47-4eee-b6e2-e1d5d64a655a
5   character_31f02ec1-5eab-4d1d-ad3d-f7f9c65e34d9
6   character_57833e11-ca7b-4799-9811-431ce4bbd66d
7   character_c0562ccd-1d9c-422e-a3a4-167c0b1d9169
8   character_3c32a1aa-9031-40e9-b1cd-6a03214c5b24
9   character_a71e4306-d385-436e-abef-784e965b1e4f
10  character_0aea927d-95ab-4c39-b476-1083244be146
11  character_484d25ee-89c7-4707-b0c2-0ad481eb2dec
12  character_16f4d977-1f54-4356-b766-44e61394d20e
13  character_99bb95ae-8963-49d2-a1bc-26d531658f9c
14  character_2cfb5e64-b34c-4474-9585-26e27d700a1e
15  character_57de219a-d29e-4e43-9d88-65459d6e055f
16  character_1f32bc37-9a28-4240-bda4-b303b768c9b2
17  character_c9ce1a49-674f-440d-aeb4-52a67bcceec6
18  character_f89e74ce-6bdd-413b-8911-c7eec189c9d5
19  character_82e5a443-2a08-4d9b-8f7a-b16b4e7fc9b0
20  character_db7726c4-b51d-4307-b73a-b9ff4dbfa7bd
21  character_fdba878d-72d2-487d-a107-13a6e5e26080
22  character_3816820e-a9ad-4648-a67e-bf3b39247060
23  character_04f37a25-f726-4dae-9a23-a9fe0c4f7575
24  character_04f419a4-5c86-40f1-8d96-3778c34a7f78
25  character_8168ebea-b0a5-4786-909d-718996b87aca
26  character_8bec2cf2-6023-4f82-b62f-37927bf8511b
27  character_155f52f4-0d49-4077-af6c-68f848a2dd65
28  character_c00c1ad7-ba28-4c3c-a906-4147836b9c87
29  character_fb95a33e-214a-455a-b0f1-29a3e84c4a7d
30  character_208aefe5-994e-435a-86f5-baf42a010bd4
31  character_b7cad3ec-0616-4562-8075-f60a477e0758
32  character_436ae262-43a4-4f71-8f4f-04af9e14db6a
33  character_edbf0764-460e-4afa-afb6-1cf84791c44d
34  character_a067f2d5-c2b7-4a77-aaab-32a93e36173f
35  character_021e786e-f2e8-493d-ae72-7e232af5b4c4
36  character_b26f9482-b1e6-48de-8d7f-14ffaf0cac95
37  character_6ff18fc9-2a14-405c-8f7f-febce8eea14d
38  character_9164cf7f-2507-4fe9-86fb-56522d9b940e
39  character_2cc085b0-dc51-4f06-8a9a-eae17cf27e07
40  character_c10d219c-dadd-4bbc-9de9-3428689be563
41  character_fd2f06c8-76b3-4e5f-a570-fb2dedabe548
42  character_026337ac-0e4a-4661-a95f-4bd9257f2f0b
43  character_49547bed-7a94-4d70-b7ef-834a9c48e2a7
44  character_db5da5be-6c21-411d-b6e4-a18546cb7edf
45  character_f5b73c41-b556-4dad-9e21-cc40079c9cd9
46  character_6629cca7-d8f1-4005-8a34-345699220a07
47  character_c3dccce2-f8d2-4a47-a66d-c0e9576c51ab
48  character_e1f36cd0-bdda-4c42-99d4-0ca9b8e83e5b
49  character_6e13ecb9-4229-444c-8eb5-1ea699f8e0fa
50  character_25636205-7356-4228-a799-456b3511df6a
51  character_f594df56-d1f9-49f0-90aa-f32c291a4fa8
52  character_2c05e29b-9815-410d-8019-6a618e7b9b6e
53  character_4db4f0d3-2f70-44c6-8057-6b44b03c1628
54  character_04900abb-c5c1-452d-b478-321e75d51805
55  character_1d2b6cdb-9a19-4c21-9a16-269478f11d76
56  character_a72c24fe-2399-4877-a8d1-88529ab03ac3
57  character_3de790d7-4f5a-41be-9c2d-96eb9cbf1514
58  character_4e27b4c7-5e8f-4241-871e-aeff35958ced
59  character_0c1c4557-1532-43d8-b2f7-bacc2da8e7ab
60  character_2f92e528-c10e-47fe-acd6-988f5b1eb9ce
61  character_0ecbd259-4318-4d27-a184-6b983e68f4b8
62  character_7df755f2-039d-4a18-a184-59514c4d353c
63  character_098b044a-7041-489c-84e8-65d27381576d
64  character_735bc0ee-35c5-4918-bf50-8223e1cb2254
65  character_39d49106-ea20-4bb3-b352-355b2a224eba
66  character_f0a246a5-29dc-4774-9b5f-5d6c5626e513
67  character_68c4f1aa-d54b-4b67-b374-681e4d41b289
68  character_f32f0cc3-cd1d-4af7-b64f-a51e73e2f477
69  character_07d8e119-f0ca-4566-ac2e-54fc6e876a8e
70  character_7f073c25-60ef-4108-b4b6-1324bf00c5c6
71  character_d499b838-842d-4598-a880-d9b892844511
72  character_24948825-b750-4608-9154-f093b019ad9b
73  character_617f00b8-162d-4c5a-93fa-14afa9fc5677
74  character_a1401005-fd38-435f-9b5d-ed392319e4b3
75  character_19da9b87-1e38-432d-aec6-8fde88872d81
76  character_fa618fc8-6cc1-4fbc-9e38-2a3c34f0627f
77  character_880a58c6-0b82-492b-91b3-cb15f386d783
78  character_3c0fae15-1fa3-42df-b6e2-dc4b32db11b9
79  character_a540566e-ca9b-450f-ae5a-f76cbf740c48
80  character_47d7642e-248d-4500-b02a-749b659ea839
81  character_4dcbdf3b-d039-4e36-a235-45860e2caa7a
82  character_c043ba32-794e-43c1-8ea6-dd150662b3f7
83  character_16102c5a-b1a8-4819-bb7b-7a0228fbea70
84  character_427dbd56-7874-4fa1-bbc3-a45a82f6f5a4
85  character_e543720c-51a3-4a9b-bf56-a4355a852504
86  character_660be2c6-6eb4-4cb1-8dc9-1c7efcf9182d
87  character_d9b9c327-1e33-4604-803e-4d46c6e77fa3
88  character_96d1e4d4-39da-4ba1-9c09-be20e62eff41
89  character_9f5a5af7-0a03-49a8-aa5c-72ab801d110f
90  character_f468741b-6bb9-4502-839d-af9ee91864c9
91  character_3f92bfbe-dce6-4341-96a0-a485bcf17001
92  character_f1278505-beaf-442a-8bf2-0d906b3d2ff8
93  character_c50ca6da-0dbe-4d1f-a8a6-f350c03ee6bc
94  character_c636ef7d-5901-431e-843d-7de70ed76e09
95  character_4c860836-df3b-490d-b84b-2eb14ad1f5ad
96  character_0c8a5144-472e-40db-a9e2-36d1067f4746
97  character_90a9f646-73ff-4a46-902d-095b5e256b0a
98  character_cb8dda8c-2e77-4822-a526-19c1754ae92a
99  character_2342ccc0-5f01-415b-912c-5ed059c38656
100 character_4f4448ea-2a50-4d91-a98e-8dd5ea629a05
101 character_aa0baeae-ceef-4510-adb5-dbe2e2a1159d
102 character_d5a3decb-02e1-41a6-aae7-a317079fa89a
103 character_5a71149e-5c73-4e21-be78-1f68da4417a8
104 character_afbb166b-927e-4cf5-aca4-fb9d44c0850a
105 character_49b70c66-7263-45d4-9292-da4a894e53db
106 character_3be991ab-2a66-43f5-8acf-ca67cc496f07
107 character_31da9265-6adc-4e46-bd5d-d3a20afdd7db
108 character_670ad36d-2e50-4160-a15f-2202386a140c
109 character_1739178f-0655-46b8-b920-7d797cdafed1
110 character_1f0fc345-4597-4f45-9345-23bea01a16e5
111 character_7ef0b845-da87-429f-83e2-f5cd46306ae3
112 character_d5b69e1c-2a5d-40dd-a3e7-5ea0aac7a756
113 character_1d4c6704-edbd-42b1-8c70-b6143a5a43c6
114 character_1aa9a921-10d8-497e-a17a-ee44f691f3ac
115 character_b6b120bf-1438-4f3b-83d2-099e3de73499</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t14bacddf-15ea-405a-bd43-e153e1cc63a6
2  t14bacddf-15ea-405a-bd43-e153e1cc63a6
3  t14bacddf-15ea-405a-bd43-e153e1cc63a6
4  t14bacddf-15ea-405a-bd43-e153e1cc63a6
5  t14bacddf-15ea-405a-bd43-e153e1cc63a6
6  t14bacddf-15ea-405a-bd43-e153e1cc63a6
7  t14bacddf-15ea-405a-bd43-e153e1cc63a6
8  t14bacddf-15ea-405a-bd43-e153e1cc63a6
9  t14bacddf-15ea-405a-bd43-e153e1cc63a6
10 t14bacddf-15ea-405a-bd43-e153e1cc63a6
11 t14bacddf-15ea-405a-bd43-e153e1cc63a6
12 t14bacddf-15ea-405a-bd43-e153e1cc63a6
13 t14bacddf-15ea-405a-bd43-e153e1cc63a6
14 t14bacddf-15ea-405a-bd43-e153e1cc63a6
15 t14bacddf-15ea-405a-bd43-e153e1cc63a6
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 t14bacddf-15ea-405a-bd43-e153e1cc63a6
9   Ictalurus balsanus VTO_0036221 t14bacddf-15ea-405a-bd43-e153e1cc63a6
10   Ictalurus dugesii VTO_0061497 t14bacddf-15ea-405a-bd43-e153e1cc63a6
11  Ictalurus furcatus VTO_0036223 t14bacddf-15ea-405a-bd43-e153e1cc63a6
12     Ictalurus lupus VTO_0036220 t14bacddf-15ea-405a-bd43-e153e1cc63a6
13 Ictalurus mexicanus VTO_0061498 t14bacddf-15ea-405a-bd43-e153e1cc63a6
14    Ictalurus pricei VTO_0036218 t14bacddf-15ea-405a-bd43-e153e1cc63a6
15 Ictalurus punctatus VTO_0036225 t14bacddf-15ea-405a-bd43-e153e1cc63a6
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label common_name
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus        &lt;NA&gt;</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>Fisherichthys 
         TRUE </code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the default build_opts will skip building the vignettes.</span>
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"phenoscape/rphenoscape"</span>, <span class="dt">build_opts=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-manual"</span>))</code></pre></div>
<p>The custom <code>build_opts</code> parameter ensures that the vignette(s) (such as this document) will be built and installed as well. (The default for <code>build_opts</code> will skip building vignettes.) Building vignettes requires a recent version of the knitr and rmarkdown packages. You can install these beforehand, or include the parameter <code>dependencies=TRUE</code> in the above. Note that the latter will also result in packages being installed that otherwise are only needed for <em>testing</em>, and for generating the help pages. If you don’t develop packages yourself, this may be much more than you need, and therefore installing knitr and rmarkdown beforehand is then the better option.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta4925e12-30d0-410a-b987-78717511bf26
2  ta4925e12-30d0-410a-b987-78717511bf26
3  ta4925e12-30d0-410a-b987-78717511bf26
4  ta4925e12-30d0-410a-b987-78717511bf26
5  ta4925e12-30d0-410a-b987-78717511bf26
6  ta4925e12-30d0-410a-b987-78717511bf26
7  ta4925e12-30d0-410a-b987-78717511bf26
8  ta4925e12-30d0-410a-b987-78717511bf26
9  ta4925e12-30d0-410a-b987-78717511bf26
10 ta4925e12-30d0-410a-b987-78717511bf26
11 ta4925e12-30d0-410a-b987-78717511bf26
12 ta4925e12-30d0-410a-b987-78717511bf26
13 ta4925e12-30d0-410a-b987-78717511bf26
14 ta4925e12-30d0-410a-b987-78717511bf26
15 ta4925e12-30d0-410a-b987-78717511bf26
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 ta4925e12-30d0-410a-b987-78717511bf26
2  VTO_0036220 ta4925e12-30d0-410a-b987-78717511bf26
3  VTO_0036275 ta4925e12-30d0-410a-b987-78717511bf26
4  VTO_0036276 ta4925e12-30d0-410a-b987-78717511bf26
5  VTO_0036278 ta4925e12-30d0-410a-b987-78717511bf26
6  VTO_0061495 ta4925e12-30d0-410a-b987-78717511bf26
7  VTO_0036218 ta4925e12-30d0-410a-b987-78717511bf26
8  VTO_0036225 ta4925e12-30d0-410a-b987-78717511bf26
9  VTO_0036277 ta4925e12-30d0-410a-b987-78717511bf26
10 VTO_0036272 ta4925e12-30d0-410a-b987-78717511bf26
11 VTO_0036274 ta4925e12-30d0-410a-b987-78717511bf26
12 VTO_0036223 ta4925e12-30d0-410a-b987-78717511bf26
13 VTO_0036273 ta4925e12-30d0-410a-b987-78717511bf26
14 VTO_0036221 ta4925e12-30d0-410a-b987-78717511bf26
15 VTO_0061497 ta4925e12-30d0-410a-b987-78717511bf26

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Pylodictis olivaris, Ictalurus dugesii, Ameiurus platycephalus, Ameiurus catus, Ictalurus punctatus, Ameiurus natalis ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_58bc20a8-96e7-4cca-b02d-03a56c28f62a
2     Ameiurus catus otu_69a764e0-417f-4b77-8ab8-a9f8cbb972a8
3     Ameiurus melas otu_2971f0a3-c497-477d-9d8a-83f12e1b340c
4   Ameiurus natalis otu_ea6e62e1-711c-4ce4-acfe-282869043c40
5 Ameiurus nebulosus otu_1ae918ba-ed29-41f3-a524-d9e69978d9f9
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1      Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
2        Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
3   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
4           Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
5      Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
6         Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
7           Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
8         Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
9      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
10      Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
11 Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
12        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
13        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
14          Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
15      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
16       Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
17  Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
18         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
19   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
20      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
21     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
22       Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
                                        otu
1  otu_24ab380f-6045-4c99-ab6d-8e15f92504ce
2  otu_62b181cb-3b1d-4416-aa11-3185c0c3fb30
3  otu_759aecbd-a268-4024-a83d-4b61379cdfc3
4  otu_69a764e0-417f-4b77-8ab8-a9f8cbb972a8
5  otu_c3f651b4-7b09-4070-8c5e-870436608bdd
6  otu_ea6e62e1-711c-4ce4-acfe-282869043c40
7  otu_2971f0a3-c497-477d-9d8a-83f12e1b340c
8  otu_5937b2d1-f728-4511-b765-c15710f415af
9  otu_b79e9ad5-7694-41a9-8476-cdb3285e9c8b
10 otu_68a2befb-2d22-4297-aae1-4d2974b51f79
11 otu_c8282af3-7d26-443d-bc93-e0b698c8e7c4
12 otu_3ac7a1a6-11e5-4d43-9002-da0a24601109
13 otu_8a09de0e-6064-41f2-9974-3382b708fff5
14 otu_e3b020c1-5026-49b7-ba90-547d93caaf8b
15 otu_1ae918ba-ed29-41f3-a524-d9e69978d9f9
16 otu_58bc20a8-96e7-4cca-b02d-03a56c28f62a
17 otu_7a8cff4e-3252-48a1-bc54-f1b21c93d108
18 otu_a5c5872b-75a3-41b0-9df4-0a93891c6c7c
19 otu_301a4204-f27f-4f0b-bb68-e2c7fd8ce19d
20 otu_bd57da09-9d3e-42a2-8983-321f0b4943c4
21 otu_313e9491-15ae-40a9-a0fe-46ed3093eaea
22 otu_c57c7bb2-154e-4005-bf36-20d463663262
                                        otus
1  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
2  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
3  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
4  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
5  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
6  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
7  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
8  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
9  otus_b841451a-42b6-44a5-8a64-4c2134448cbf
10 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
11 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
12 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
13 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
14 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
15 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
16 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
17 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
18 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
19 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
20 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
21 otus_b841451a-42b6-44a5-8a64-4c2134448cbf
22 otus_b841451a-42b6-44a5-8a64-4c2134448cbf

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_eb51573c-4ab5-4c5d-9a2b-457688d040c6
2   character_4415c218-62d4-44cb-85da-3508a3d16d5a
3   character_0429b1a1-fe5e-4cd2-8b52-2d03023391ec
4   character_a2b2d3dc-27fb-4855-8714-9123c8d1ea8a
5   character_a5e03b99-f5d1-4762-aaa2-3d61118bcdd8
6   character_71dd0db0-69d8-42b3-89f0-a9aaa70b3c51
7   character_b7d4ee9b-b482-4da5-a0f3-bcf2ab7e350a
8   character_f41a9a85-8d66-4e0e-8d62-24560cc52ed1
9   character_64bc0024-74fc-4e26-88a2-be7eabaccb51
10  character_df7eca68-5d35-4650-b265-ac45ce9f625e
11  character_972c1c56-e02d-4eb9-a9a0-76846087a7b7
12  character_d98db3b4-d58e-4e79-9c9b-1277309fe90a
13  character_54a42f8d-99d6-46a5-a8aa-44c5066f938f
14  character_a2af9fe5-7d44-49cd-ba65-433c4e035548
15  character_7e561d39-50c9-46ce-8d09-cc61b14d9202
16  character_eb51c1bb-81d2-4cec-9046-9cddcc7a72fd
17  character_fadf5e9a-22b4-4afb-b590-e79d88e268fa
18  character_a78bfb89-9f8f-4fb5-8040-828174679c36
19  character_d31b29a4-8d4b-4c61-8403-6495f25e41f2
20  character_ee964e50-ceb4-4655-b967-9a1d93982d7d
21  character_aba3788c-2b8d-452c-8aaf-d237b24dd5db
22  character_0f4c6e82-074a-4201-a890-5008e9f2252d
23  character_bc818a9b-3a83-4d34-90d6-f23760054843
24  character_afec56ca-b4e9-4081-9de4-5b67dafb8150
25  character_7674d7a6-6d0a-4308-a02f-cabc7b97e06b
26  character_17dad974-5963-4643-95cc-a52b39e6f0c5
27  character_92ab24aa-32d9-407a-af9e-b7158becf9f3
28  character_cc6b9899-f5c0-4d9c-aec6-3eb420932e9f
29  character_d9e99897-b8e4-4318-a1b4-3cac047f54d7
30  character_48cb98d7-6bbb-4ba6-a12d-44900aff854e
31  character_736e39ac-a5bf-4021-840f-0d16938e3197
32  character_a78388d0-e224-4c30-a6cd-6481113359fc
33  character_073f92e6-0448-414f-9c3d-392591b79884
34  character_f92b02f3-b58a-474a-b7e6-946210e22c13
35  character_5cc08e9d-5a78-4bc8-a407-a3b172bc0b64
36  character_56b0a783-52d7-4c54-8f1b-ec6b2da2e90a
37  character_86c33140-bce9-4544-b4ee-791cde28ebb5
38  character_ae12a7f3-958b-4ff6-8dfa-97ecfed2be71
39  character_68fe3ced-146b-4218-9e8a-249c08ce19f7
40  character_d9f49109-f274-4432-8a11-a6201494ebe9
41  character_08839d87-ad97-42b0-8a0c-38ff4763c00e
42  character_f842d88d-f6ae-44eb-9fa0-65605853b147
43  character_34f8a56f-72cb-4b64-b380-b855cbe4a803
44  character_db19904d-3b87-4d4c-8472-0fb8dcb38232
45  character_717cc457-0bf4-4bbd-9f49-8bf16a49e972
46  character_1a87c8b2-3cd1-40f5-b302-9bd5f6a76f9a
47  character_13e3f400-0828-43a5-948a-2a039b8d5595
48  character_b919fbca-88cd-49d4-a20d-3ecfbd61d1bb
49  character_82e90f03-5130-4a0d-9ac7-8bd476063aca
50  character_4499c0b3-840e-4359-a7bd-c3b5ccff8101
51  character_53ff7ef8-5529-4a10-9af7-be9f154fc641
52  character_8c355d91-6d28-499f-87d2-fe9ba55f3372
53  character_fd49c057-8c30-4579-b886-26bfc37a7960
54  character_61e260f4-654d-4012-a79a-5e4ed2eed0aa
55  character_2268895a-e11d-4362-bd2a-cb9a4f1b38bf
56  character_97469f42-795e-4189-bbed-98d8d32ded0c
57  character_e1355cd8-2bb5-4d11-9a65-4e5f0e5ce4d2
58  character_9e466f77-a283-44e6-aed1-15e5949b4722
59  character_9f791c0c-9b06-46d0-8896-956af22080b2
60  character_ad4e647b-3901-464e-8bd9-01d53491683a
61  character_25478dca-2ee0-411d-8bbc-ad3cd7f3c42a
62  character_7d559daa-e6a2-448e-992b-4e31d65b8ad5
63  character_b5caf019-988d-45f5-bb39-1ff885f71c32
64  character_01e3d09c-b3b3-47ef-815b-2714d4b1ba28
65  character_f701fdb4-9711-4138-95b6-2fc90bb3b01f
66  character_305a45c3-117a-45c1-944a-4cbbdc283d94
67  character_4efecd17-4f56-4059-9e9d-483036932b8b
68  character_fd723247-2d75-4060-893a-df5e8b7e9cec
69  character_268d74e4-0dd9-456a-b121-45b5e70f80a0
70  character_5e4a729a-16cf-49fa-a432-bbd1c4985275
71  character_96c8a3ef-ae46-481f-9d99-73762cbb3a85
72  character_aaf8c119-acc2-4033-a396-10dc3ea1bc20
73  character_e9315955-40dd-49dd-af8d-f81d3bd5f404
74  character_5288fdb4-d8d3-4600-9ad9-003f8d12dedc
75  character_25c99aea-d19b-4675-9832-679386c30791
76  character_e4198b34-0f0f-4c24-9e75-c1e2b9e92794
77  character_90a43b85-bd81-4fa6-8ba4-a3ae3b715aac
78  character_89546ad0-a308-4566-90d0-3c786db074cd
79  character_ad5523e8-7a89-40ca-943f-8f1ac73a9998
80  character_5736c77c-8ed4-454f-810f-f062635fb7a8
81  character_0833f9ca-48fe-4bd2-bf26-6080cff2a7bd
82  character_b9e30331-9d3c-44d2-bc42-48233a78678d
83  character_db6c959b-04c5-49a2-822c-0a517822d140
84  character_3d47e0c7-0383-496a-b815-043152e10614
85  character_d25440b5-eb37-44a8-8a05-27097ae1fc7a
86  character_865a4611-188c-4666-9895-f57e36a09e34
87  character_0acb5b0e-7a99-447d-b435-a030341bfbef
88  character_1a01107b-b9df-47a5-8d84-195dbd0eac87
89  character_6a90926c-ee32-4229-8a3b-8271064ffe2a
90  character_78edaace-3d8a-4a76-b241-b55f82e02864
91  character_4d054286-a9b9-4a2e-82f1-28892c608c96
92  character_7ea24a83-8fc2-4fb4-ad69-900872043bcf
93  character_bf4ff077-0910-4e6e-adae-95b37d96b9a7
94  character_289f289d-a7ed-4e83-90ea-9b32210cb25d
95  character_090537c4-8ab4-4c74-ae17-c33e39932162
96  character_00016216-8427-4e7f-b165-ce02cfe31993
97  character_5b6123db-0f28-4e5e-a1f2-46152d86699c
98  character_e380f680-4280-4d1c-8966-57c4766f11a1
99  character_9e2e1d0d-b570-4c7f-a587-b1e3c7211294
100 character_4f8f4b78-635e-43f3-a14e-965d9dc5559f
101 character_ade921a1-937c-453f-a0ee-27a78bf3286a
102 character_745f34d1-a0b6-48d0-adcf-b5b1519275c0
103 character_88270bd4-4b6d-4bc9-8c3a-fff72544265f
104 character_5acfd1e7-e6ed-44c7-8a5f-9cdeb43a8320
105 character_59434e16-0508-4fb0-9d73-93cb26d1c55c
106 character_f03d2bb4-fd76-4361-8fae-8a3d398330c2
107 character_2170a802-4448-45fa-a196-45713cfe6f14
108 character_b6d0abb2-a4fa-464b-84c7-2a15c8b355fc
109 character_d632ca72-c020-4ee9-8e5d-500621546c47
110 character_c0be8459-4298-4e88-8453-f88d68ad357a
111 character_9fd880e6-339f-4907-bbe3-2137ae5e684c
112 character_402916e9-8005-4b01-83c1-597f1a202690
113 character_a6012232-5661-4d5b-aa97-3f7f59f64cfd
114 character_fca17f77-2d39-4566-b40b-232e3666fd5b
115 character_987d593c-fdc1-4081-8f37-dbe8c83896eb</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta4925e12-30d0-410a-b987-78717511bf26
2  ta4925e12-30d0-410a-b987-78717511bf26
3  ta4925e12-30d0-410a-b987-78717511bf26
4  ta4925e12-30d0-410a-b987-78717511bf26
5  ta4925e12-30d0-410a-b987-78717511bf26
6  ta4925e12-30d0-410a-b987-78717511bf26
7  ta4925e12-30d0-410a-b987-78717511bf26
8  ta4925e12-30d0-410a-b987-78717511bf26
9  ta4925e12-30d0-410a-b987-78717511bf26
10 ta4925e12-30d0-410a-b987-78717511bf26
11 ta4925e12-30d0-410a-b987-78717511bf26
12 ta4925e12-30d0-410a-b987-78717511bf26
13 ta4925e12-30d0-410a-b987-78717511bf26
14 ta4925e12-30d0-410a-b987-78717511bf26
15 ta4925e12-30d0-410a-b987-78717511bf26
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 ta4925e12-30d0-410a-b987-78717511bf26
9   Ictalurus balsanus VTO_0036221 ta4925e12-30d0-410a-b987-78717511bf26
10   Ictalurus dugesii VTO_0061497 ta4925e12-30d0-410a-b987-78717511bf26
11  Ictalurus furcatus VTO_0036223 ta4925e12-30d0-410a-b987-78717511bf26
12     Ictalurus lupus VTO_0036220 ta4925e12-30d0-410a-b987-78717511bf26
13 Ictalurus mexicanus VTO_0061498 ta4925e12-30d0-410a-b987-78717511bf26
14    Ictalurus pricei VTO_0036218 ta4925e12-30d0-410a-b987-78717511bf26
15 Ictalurus punctatus VTO_0036225 ta4925e12-30d0-410a-b987-78717511bf26
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>extinct 
   TRUE 
Levels: TRUE</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

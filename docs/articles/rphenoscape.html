<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>). See the <a href="https://rphenoscape.phenoscape.org">package README</a> for details.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
2  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
3  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
4  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
5  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
6  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
7  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
8  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
9  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
10 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
11 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
12 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
13 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
14 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
15 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
2  VTO_0036220 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
3  VTO_0036275 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
4  VTO_0036276 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
5  VTO_0036278 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
6  VTO_0061495 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
7  VTO_0036218 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
8  VTO_0036225 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
9  VTO_0036277 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
10 VTO_0036272 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
11 VTO_0036274 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
12 VTO_0036223 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
13 VTO_0036273 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
14 VTO_0036221 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
15 VTO_0061497 t0d56ad07-3129-4812-b48f-5b4d5ce895a5

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Ictalurus lupus, Ictalurus mexicanus, Ameiurus brunneus, Ictalurus furcatus, Trogloglanis pattersoni, Prietella phreatophila ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_8985e6a0-7cf3-4019-a964-a7cec83fc9eb
2     Ameiurus catus otu_c63b2154-2be6-47df-8d27-cd3568287900
3     Ameiurus melas otu_baf69862-dbe5-4e0f-8012-ba81966c146d
4   Ameiurus natalis otu_ea5132da-ca01-4b1d-afcb-3370f57e4337
5 Ameiurus nebulosus otu_dce96f1e-1bbf-4d0f-9084-0c83a7d5c2c9
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1          Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
2      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
3        Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
4       Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
5  Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
6   Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
7      Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
8      Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
9   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
10        Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
11     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
12   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
13          Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
14       Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
15        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
16        Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
17        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
18      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
19       Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
20      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
21          Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
22          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
                                        otu
1  otu_c653b306-aba5-49f1-94af-83fac6b0c869
2  otu_1c38aa28-d2bf-4cbe-a3fa-844b0dfcb946
3  otu_8985e6a0-7cf3-4019-a964-a7cec83fc9eb
4  otu_b5b5239a-a7a0-4bbe-b75d-9dc1de9667e8
5  otu_9168ebf9-4e48-4923-a17d-371d87988ffb
6  otu_f1fdc21b-406c-4bd1-acef-810896759195
7  otu_6dd976f0-cb7a-4f5f-be98-0da5cbe21762
8  otu_ac0dfe75-159d-43a3-a7a5-a12e65845586
9  otu_17dcade1-03a9-400c-b986-1d00d611cf19
10 otu_ea5132da-ca01-4b1d-afcb-3370f57e4337
11 otu_1bcfd2cf-c4e0-4b2e-b8f9-ff63ed94083b
12 otu_001ba7bc-8f7e-4193-8262-116415785317
13 otu_a4f8bf1c-614a-4a51-b03d-63b6aa26324c
14 otu_ba02a5cc-c376-475a-9cb3-4fbcd4b45f11
15 otu_dcc96759-9d43-4900-885b-61dd98a7f64e
16 otu_3493a5f5-b5a9-4feb-aa8e-2d80db10ed39
17 otu_ad681d05-d802-4cb2-b912-9613a2d78861
18 otu_dce96f1e-1bbf-4d0f-9084-0c83a7d5c2c9
19 otu_730cbacd-bde8-40aa-b4cb-74d24ba2e190
20 otu_5398e9ff-7d19-412e-8632-ddc8d2e7c4a1
21 otu_baf69862-dbe5-4e0f-8012-ba81966c146d
22 otu_c63b2154-2be6-47df-8d27-cd3568287900
                                        otus
1  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
2  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
3  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
4  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
5  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
6  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
7  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
8  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
9  otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
10 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
11 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
12 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
13 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
14 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
15 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
16 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
17 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
18 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
19 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
20 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
21 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d
22 otus_d5c25aa1-0df6-4230-949a-9fbc5a70ed3d

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_d7e721de-de08-479e-bc65-e6fb3f9e03e4
2   character_7054e36a-f957-4a82-ae1d-8a2896cea6f0
3   character_8da2680c-3764-4ac0-bacd-a8ea2452494a
4   character_bf9e8e44-220a-44a2-bc78-72f18be0bdb8
5   character_8483ce36-6d3f-45ac-b1bf-0597dac54098
6   character_6d7f1921-1cb5-4d4b-9561-41bb8a7a51c4
7   character_cdadc5b5-ba45-489b-9ad6-766e753c3376
8   character_679b7749-38f0-43c3-a458-ec8a2ab50d5a
9   character_1d7b270a-bb70-4acc-b398-33ba892a7598
10  character_633f1b71-5526-442d-8022-21624a976b07
11  character_345ed208-d865-4202-9306-8fd942519a98
12  character_26fc8d47-5daa-4e61-9af2-4e22ae0c3998
13  character_b56925b3-2997-4e5c-b5bc-f89e3e6f3587
14  character_d9a4c09d-a81f-4a31-a2a5-5686bcd2e66a
15  character_dd3855c0-7467-42c7-a542-05d3fe29a798
16  character_4c0f4660-042b-4ff1-a02f-2c15440580a2
17  character_7637533b-c723-452b-9d46-e858b50ead57
18  character_c820039a-913e-4346-9ccb-91915a05894a
19  character_02b257c6-856e-4a24-beaa-de325680cd75
20  character_481c2bb4-3840-491e-afa7-dcb17071a220
21  character_cfea21e0-bf0e-441f-8289-f6f3fab112d4
22  character_036e6a4d-1d64-47a9-a4a0-2eb72ea2b104
23  character_ccd35600-7cb1-471e-b5b2-98dabc16d48e
24  character_facbba67-50c5-4fa3-9b0f-7d74c52f3f9f
25  character_bbe5affd-a6c2-4110-bb13-726a24876159
26  character_2ee401a9-0197-4eb6-857b-003511cda950
27  character_7323c2cd-071f-4a70-bb91-848ecb60c28d
28  character_a0a2904e-6bf6-4cce-8824-2fd2a2068cd0
29  character_425c0fbb-b565-497a-83db-414017446092
30  character_9b6b0183-da75-44e5-b3b9-3b3872f12af7
31  character_4affd8c6-ed1e-4d78-894c-bd5fc6d20282
32  character_b8635347-6a39-4234-b9bd-6162ecbc3049
33  character_c361c98f-3b5e-4ffd-a557-0677de67cab6
34  character_1edfef5a-58ec-4e05-959a-e11a97f06449
35  character_64086003-f132-49ce-905d-2a4873b4724b
36  character_648612ba-fa7c-4a90-9b56-b853baaa3984
37  character_2ca8f75c-623f-4efe-bfef-10a2c59823ff
38  character_fe2509a5-877b-43de-ac71-0fc04235247d
39  character_19a707c1-2a20-4cfa-9361-9ae19e1d2954
40  character_f17fbd68-3db3-4b6e-b271-b78326239c43
41  character_bf628ce4-1013-4838-85e2-33e2bc83e7aa
42  character_dea26207-e94b-4cb5-8dbf-9fb8ecb6247f
43  character_30d7c5f1-1197-482b-80a9-910ef12b4f92
44  character_4a2eaa49-e838-42bf-b2c0-3ba020caeba1
45  character_d0403e16-c719-4996-a70d-449ac128555d
46  character_e97b9e9d-683b-4894-88e4-c779a20b0cba
47  character_75d55382-08fe-46c5-a142-83654c93f3d2
48  character_d18ff982-9fac-4ab7-b545-5fc1730f3c49
49  character_286c5c2b-c59a-4b2d-96fa-d72e8f9bc029
50  character_821c9b4b-6f05-457d-9b60-8f60bb5eeecd
51  character_d2e7f56f-fa84-4fb3-a93c-289f11932832
52  character_0a8454d4-ec5e-4a05-b7d5-1722745eefb2
53  character_179d5943-a75f-4a46-98ad-b5b54982d069
54  character_0b8c8774-c797-469d-93c5-32cc366dfc6d
55  character_dd9ad18f-76a4-44b6-a87d-38ad48f22bfe
56  character_c9e706d7-4ffa-4e51-8871-9bc6d82de893
57  character_fdd2c13a-ae94-4f3c-a951-3cbab6c26b8a
58  character_f9a7036f-ac27-4dd1-8a3f-41dba11e7be6
59  character_a04130e8-8264-4dca-a429-dcd143fefb22
60  character_5f945b5b-0a83-4fc7-b8de-764a1b9b7796
61  character_4df46cda-9ba0-4e6e-996b-e3ab3be3af46
62  character_35fbe4b2-8029-4064-9196-a07bfde63706
63  character_37cf8f84-c914-432c-b244-a146646b2067
64  character_7d623848-e0e0-4d40-a62d-5ac607b5bf76
65  character_25e58805-7c38-493d-ba57-581bd0b948b8
66  character_f2acfc22-1fd3-447d-a24a-dd29a19c9bc5
67  character_c248091f-01b4-4fbd-9d4d-6ebcee451640
68  character_08a0b3cf-296b-42e7-aed1-2c0c4e36c9da
69  character_35cf7a85-ad79-4ad7-ac4b-5afc35a70bd4
70  character_300ec184-c54c-4da9-9d7b-881916eb8c24
71  character_55ea47bc-1c82-458a-8135-e250cfaef8ef
72  character_de352e25-e4a7-418b-ac88-ac34fb670f63
73  character_279c6501-ab21-43b1-b53c-c4f7b31ddb2b
74  character_2916654e-dcf8-4b14-b76c-16e4e2f77895
75  character_fb1074a5-7db5-435e-abfe-6f4f91a14e6f
76  character_1c15c5bd-a933-49a1-855a-ba8066f2ef4e
77  character_5b251839-ba92-4fe9-a8b8-8900a4fd17d6
78  character_7e500f92-7e26-4165-8f84-ca6c883ff3e5
79  character_2737aa12-1c90-4322-837d-0f6c01b07c34
80  character_08438e38-24fb-4fb2-90ef-8707aa397b95
81  character_96d439f1-241a-4216-a05e-3423da334a70
82  character_2a4ecd02-1be3-44d2-88e8-64e833e49f05
83  character_c0ae196a-feeb-4a23-9f9f-4e550513a37b
84  character_6cfa07cb-310a-481a-b6b6-29a63ffbe825
85  character_b170ee75-f907-44a4-a75a-85935be7bfcb
86  character_a395a924-9fa2-4062-b502-a775b0d9fd41
87  character_f447b4b0-908e-4815-8870-0e989fd12b65
88  character_758dee67-0e27-4ca1-9e60-3c34c6da6dda
89  character_91a2a899-4ab8-4da4-a841-f3da04852b4c
90  character_f5a58e35-51f6-4901-aee1-6fd05428ebe6
91  character_340e49a5-dd7b-4283-8441-b9afd91fe5ef
92  character_f483baee-d422-454b-ab5c-2e046a19f6c3
93  character_897955b7-6519-4ea4-a519-6c0ce418b016
94  character_928ccf2f-9a6b-41a0-a7f4-432c50b49872
95  character_3422d5b0-1c59-4e10-9122-024ce5a5b03f
96  character_e4e64b3e-85ea-4084-b8cc-88f29448e3fc
97  character_c9a086e8-b7db-4909-bc52-0ef5c0f94005
98  character_5344c932-cdbf-44ec-b52d-8ca72b557f50
99  character_edaea0b3-1dc9-4091-9fa3-a6006018845f
100 character_1e099e00-ec33-414c-954e-80da7bbff409
101 character_f148cdcc-2e82-499d-99cc-dfad676e2b05
102 character_128adc55-3dee-4b22-b113-7a4dcaa1aea9
103 character_5200212c-194e-4d64-aa07-0e30c86dd8f2
104 character_b45392af-44b5-4fca-950a-3803c47b8086
105 character_bbc1e6a1-fa97-42be-be78-3fd6f52a664d
106 character_211fecbb-c082-4a76-929c-75c5edbdb8f5
107 character_0421fa47-8e52-4d98-a0fd-42ae4e9576ba
108 character_752c13c4-a9e3-4154-b5da-9a0cd76bd0c9
109 character_3014951f-11f8-41f5-8b07-5c3ab93bfcd1
110 character_285f7ccf-8d4d-417f-b689-4f7c5f5e3e11
111 character_26da5545-c53d-4886-b886-6a9624c155da
112 character_456bd7aa-6f93-4f01-9c09-40a1e0b6e152
113 character_ea0c2a38-9ef0-4026-8e91-a51bac4eebe2
114 character_cd37fb2a-a68a-4fa5-96c9-bca9684da449
115 character_7a3386f3-684e-47b5-9760-cfbf0c00b6f9</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
2  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
3  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
4  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
5  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
6  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
7  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
8  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
9  t0d56ad07-3129-4812-b48f-5b4d5ce895a5
10 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
11 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
12 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
13 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
14 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
15 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
9   Ictalurus balsanus VTO_0036221 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
10   Ictalurus dugesii VTO_0061497 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
11  Ictalurus furcatus VTO_0036223 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
12     Ictalurus lupus VTO_0036220 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
13 Ictalurus mexicanus VTO_0061498 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
14    Ictalurus pricei VTO_0036218 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
15 Ictalurus punctatus VTO_0036225 t0d56ad07-3129-4812-b48f-5b4d5ce895a5
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label common_name
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus        &lt;NA&gt;</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>Fisherichthys 
         TRUE </code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>). See the <a href="https://rphenoscape.phenoscape.org">package README</a> for details.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t296dba9d-b9b0-46bd-a339-94aaef32f544
2  t296dba9d-b9b0-46bd-a339-94aaef32f544
3  t296dba9d-b9b0-46bd-a339-94aaef32f544
4  t296dba9d-b9b0-46bd-a339-94aaef32f544
5  t296dba9d-b9b0-46bd-a339-94aaef32f544
6  t296dba9d-b9b0-46bd-a339-94aaef32f544
7  t296dba9d-b9b0-46bd-a339-94aaef32f544
8  t296dba9d-b9b0-46bd-a339-94aaef32f544
9  t296dba9d-b9b0-46bd-a339-94aaef32f544
10 t296dba9d-b9b0-46bd-a339-94aaef32f544
11 t296dba9d-b9b0-46bd-a339-94aaef32f544
12 t296dba9d-b9b0-46bd-a339-94aaef32f544
13 t296dba9d-b9b0-46bd-a339-94aaef32f544
14 t296dba9d-b9b0-46bd-a339-94aaef32f544
15 t296dba9d-b9b0-46bd-a339-94aaef32f544
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 t296dba9d-b9b0-46bd-a339-94aaef32f544
2  VTO_0036220 t296dba9d-b9b0-46bd-a339-94aaef32f544
3  VTO_0036275 t296dba9d-b9b0-46bd-a339-94aaef32f544
4  VTO_0036276 t296dba9d-b9b0-46bd-a339-94aaef32f544
5  VTO_0036278 t296dba9d-b9b0-46bd-a339-94aaef32f544
6  VTO_0061495 t296dba9d-b9b0-46bd-a339-94aaef32f544
7  VTO_0036218 t296dba9d-b9b0-46bd-a339-94aaef32f544
8  VTO_0036225 t296dba9d-b9b0-46bd-a339-94aaef32f544
9  VTO_0036277 t296dba9d-b9b0-46bd-a339-94aaef32f544
10 VTO_0036272 t296dba9d-b9b0-46bd-a339-94aaef32f544
11 VTO_0036274 t296dba9d-b9b0-46bd-a339-94aaef32f544
12 VTO_0036223 t296dba9d-b9b0-46bd-a339-94aaef32f544
13 VTO_0036273 t296dba9d-b9b0-46bd-a339-94aaef32f544
14 VTO_0036221 t296dba9d-b9b0-46bd-a339-94aaef32f544
15 VTO_0061497 t296dba9d-b9b0-46bd-a339-94aaef32f544

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Ictalurus lupus, Ictalurus mexicanus, Ameiurus brunneus, Ictalurus furcatus, Trogloglanis pattersoni, Prietella phreatophila ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_882ce8be-6b4b-4885-99fb-c31d45b960d8
2     Ameiurus catus otu_6e1dd0e6-3825-43c8-ba3c-2c5d9da92496
3     Ameiurus melas otu_62336fe0-aaa0-4fbf-9cf2-2d061acb7420
4   Ameiurus natalis otu_f238ed88-f2e5-4386-bb74-d13552d05cc2
5 Ameiurus nebulosus otu_182dd1ea-fbe4-43d2-b985-f385eeeadf15
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1          Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
2      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
3        Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
4       Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
5  Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
6   Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
7      Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
8      Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
9   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
10        Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
11     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
12   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
13          Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
14       Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
15        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
16        Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
17        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
18      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
19       Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
20      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
21          Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
22          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
                                        otu
1  otu_5b88b047-6ac0-45f2-ada4-5569fdd6d45c
2  otu_ef45fc2d-d4d6-4f38-a90c-8dd642aa0077
3  otu_882ce8be-6b4b-4885-99fb-c31d45b960d8
4  otu_f510e205-149d-4d11-91ad-8edc40746cd3
5  otu_bc8ecb42-369b-48ee-9c0c-91dd24309d1f
6  otu_c1f799fd-b832-4532-acb4-4926cad0a483
7  otu_2d0c999e-3d1e-4d82-8e78-5683d56ca6b2
8  otu_27a2cf17-cb77-40b1-9aac-a79fa0926074
9  otu_2e4fde79-47c9-40df-8298-b201e433462a
10 otu_f238ed88-f2e5-4386-bb74-d13552d05cc2
11 otu_c96f9df9-dcc4-477b-b547-7afe303aa1aa
12 otu_69c58473-03c5-451e-970d-cec40af96cf1
13 otu_8869046b-3671-45e6-9b54-b66be666488c
14 otu_50f80b99-c635-48d6-b3cc-d15fe383ec6c
15 otu_05dcdcea-b0d4-4001-acc4-042d933c39eb
16 otu_67995971-e5c5-41d7-9a22-49415038668d
17 otu_bd38e431-256d-4097-a33d-791745c093ac
18 otu_182dd1ea-fbe4-43d2-b985-f385eeeadf15
19 otu_0517ce6a-e53d-49b4-a216-9d8f4e391b1f
20 otu_dd6e3492-5894-48a7-8ca7-d1c4591f2365
21 otu_62336fe0-aaa0-4fbf-9cf2-2d061acb7420
22 otu_6e1dd0e6-3825-43c8-ba3c-2c5d9da92496
                                        otus
1  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
2  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
3  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
4  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
5  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
6  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
7  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
8  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
9  otus_7ce2e979-a774-40e7-b51b-78b7e514f731
10 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
11 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
12 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
13 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
14 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
15 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
16 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
17 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
18 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
19 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
20 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
21 otus_7ce2e979-a774-40e7-b51b-78b7e514f731
22 otus_7ce2e979-a774-40e7-b51b-78b7e514f731

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_e9f1aed2-63d8-4af1-ac18-276acf1c2e7e
2   character_53c1c810-102b-4c94-96be-38a880bac698
3   character_b932bbae-5fa4-4388-bcea-73a860dfcfe6
4   character_a35141a6-3d01-455b-881b-1e1fd46bf400
5   character_b849b35c-119e-4dc7-ab06-8ac76a5690fa
6   character_9dc1196e-5f9d-4418-9f6f-e04e5f972b24
7   character_1ad5c34f-7441-48b5-988e-6d36b72cf999
8   character_44bc0fcc-9f89-4a19-919a-d86bfec0eb47
9   character_0b22cf10-36ad-40ba-bcd3-61f6b818db21
10  character_0ea32d49-3589-40d1-9dc7-b425c2d65250
11  character_02f128bd-f18e-44e4-9895-69a415b00d2d
12  character_cf7d296f-43e8-4c9c-a69b-ddbdfa7ae814
13  character_6453f853-4acb-4698-b913-017abab9adb6
14  character_128ec2f1-cec0-4589-844a-d83fe1998f8b
15  character_4496d667-5e2b-4d0b-97a1-2ffa42552fd2
16  character_ead80224-8353-4b1e-b52e-e1cbf0fccce6
17  character_2f40a6ad-e13e-44a5-a68f-447f0200c2a4
18  character_41a80a41-c6d8-463e-840a-27d56824d664
19  character_a3bc2999-07a3-4a22-bf27-9377c07c6784
20  character_e9b088b4-58f1-4df6-b791-da642eaea6cb
21  character_52e7baf5-4a04-4c14-809d-812cf1e04f9b
22  character_4620a2ae-a715-4159-bd50-0961e7166639
23  character_38ea20cc-08cd-444d-98f0-685de64b05de
24  character_c89b683a-641b-4d4a-ba1e-e5ddaf919b47
25  character_c7031972-b6bd-40ec-b376-816f5d961485
26  character_a404ad1f-ec1b-4344-b16e-eeb9a3a564ac
27  character_43047615-40fd-4b70-8a26-80d2296a30ba
28  character_9e36f094-3242-45d9-813e-6061da094e88
29  character_62f309f0-62d5-4e69-be5c-c80eeead4494
30  character_af202cbb-3119-4d18-aebd-6f38c8b4f8cf
31  character_7e2a8b72-13dd-49c1-9ea9-649362381838
32  character_f5184416-f6cf-4c48-8e2d-ab6ba62f59f2
33  character_5b339421-ea36-4ac9-947c-4e53b8ad0b5d
34  character_8fff0572-052d-4104-86f4-58e2b39323dc
35  character_50285fd8-c1e9-4185-8c4b-809373cbc848
36  character_a5a6cbb5-4c83-486b-bc11-128c2293b6b7
37  character_48f5f8b7-b068-4226-ba61-9282b7079548
38  character_0399b941-fd8f-4fdd-a543-2346a83e5982
39  character_0bd59947-437b-4760-a605-be9eeb157158
40  character_cd54fa3a-702c-425a-b951-eceda6876ad4
41  character_fcc1888a-ff67-4359-b13f-49e27139edc8
42  character_4c79aac0-92f6-4dea-b7d2-0311ba34139d
43  character_cdd11f5c-273e-4507-a7e1-15d9089780f3
44  character_10f834e6-1565-4c9b-8408-0c3d002ffb4e
45  character_23828712-bcff-404c-b396-410ef9031588
46  character_b2970bc1-aa47-45e5-8f56-faa90020a33b
47  character_a003906c-6998-4e96-a67e-521753eac234
48  character_77ff4f03-4fa2-4b48-b72f-97743ad8b758
49  character_473be438-5765-40a9-bf60-e1b78f0895d9
50  character_56819d45-0483-454b-a33e-61774519aeb4
51  character_e51edfba-7e10-4f8d-9511-3c709d593218
52  character_4bc26a77-c184-4840-8546-b5a0b841bff6
53  character_f658f5b7-ddcb-4fb0-a617-b8d3ac41141f
54  character_0ac43b21-6ad1-4904-85c8-dff4308fc7be
55  character_ba949715-955b-4cf9-a78d-ea7764e25329
56  character_67afecca-e82e-4c77-96dc-42d2a6dfef3a
57  character_6aae27f4-2b33-4848-af40-aecebdeb0992
58  character_f2091641-c3a1-4834-8332-cac70f511643
59  character_a6d2d57f-b27f-40e2-a7fa-50977e6a05f6
60  character_1dc123b1-a25f-4a80-a9cc-f87287481be7
61  character_66bf3f1e-503e-463a-b8d8-9b55d871d2e7
62  character_5e0a54b2-b257-4776-88a6-59b5858f7024
63  character_4bdceff8-feff-440b-931b-12d209114b77
64  character_21a2fb85-9eb1-4662-802a-a2bfe4cedc59
65  character_58e0b752-70ab-4d55-a590-34a69bfe89b9
66  character_1d95e39b-ad71-4a05-867b-ec56565f97b1
67  character_4af814d1-3ba0-472f-8c0a-ffc9866328dc
68  character_2e579f70-20ca-4137-8015-89a1ac019a41
69  character_03940bce-6fff-4bc9-8ce6-f243781e3103
70  character_2b94e2c2-14ad-4aac-a5f9-914b67c16b5f
71  character_d5200762-a685-42e2-bbd3-240701897c55
72  character_6bd14b74-53db-433c-a49a-e30eb9da1e48
73  character_70c92764-82fd-477f-a3eb-cd995b94f85f
74  character_95023c27-3637-4b97-be7e-4a25d028991b
75  character_d8de4bbf-1f89-44e4-8150-16680531a17d
76  character_c475f7a3-f336-4b9a-8e34-9c8a96e94dcc
77  character_9069a13e-e9b6-4128-a10d-1081c35343b0
78  character_4a979e9e-e083-4b6c-bd72-3cbf4ef13ea9
79  character_76482df7-d2a0-4d8d-9073-588b411eef5f
80  character_5a82ae43-fd64-4246-91e0-c8fd73f8f287
81  character_c36f201d-a336-4072-a80d-73da3fb94d35
82  character_f819ca8c-ee41-4e1a-b6f8-9a8d0e233ff8
83  character_0a5b1207-12f9-4b68-89eb-3f96d48c7f31
84  character_396e278f-b4c8-4bb0-a852-9acf73607cf5
85  character_49130ca2-27c8-41f0-ae13-f73a52958e38
86  character_20199aeb-8115-473c-8435-f593826f697d
87  character_2f968292-6c01-4c5f-a307-449a542bbce1
88  character_a62bec43-5cff-441c-b6d1-2212c8daad78
89  character_a7960907-9f88-4926-9fac-bea7080feec0
90  character_ace92cb2-9bc4-4bcf-bfbe-11447d8c28fa
91  character_3befadac-5f23-48b0-981b-6a5f989d4656
92  character_e315b870-5a3f-4824-9cda-7976328e9d93
93  character_995d5a8d-76fb-433c-8546-e9ccc6fe51f2
94  character_d64e388b-8f13-4396-b872-a47d94736f82
95  character_2ff55f58-b969-49ba-a53f-797de8eaea93
96  character_889b9640-7d2b-4b83-b1ea-9d87ac6eab70
97  character_b0943988-3c0a-4f36-abf4-6b818301bd42
98  character_bb617820-c0fa-42ea-876c-f9166763f608
99  character_cfe83534-c813-4bc7-9f2e-d8d1a679bd44
100 character_c31537f9-abfe-4fa8-a4a9-fa9c630a16c1
101 character_643c3214-cd8a-4fa5-940d-58a4559d800a
102 character_ea1fd398-7b7e-4bae-a41b-f8f8d00a7835
103 character_1af08afe-bf40-4059-956d-cd0a3e4d5a97
104 character_2022f14e-f64d-44ae-977f-263dcfd1a240
105 character_79d21fd9-de11-4d5a-8d28-f383a4c38728
106 character_202658b4-b402-410a-8dcc-1284c3233b96
107 character_8eea2cfb-3a07-499b-8ca7-4a33e0adcc5b
108 character_01a0378e-fde1-4d7f-884e-44a536df190f
109 character_e4ae9bcd-8fbf-4016-add2-967e65d02285
110 character_3367db63-79ba-4624-8dbe-6c3e71426999
111 character_a9c450b6-1981-4eb6-8cf4-f4d40b2fa9e8
112 character_39a849c8-903d-4328-9e00-96cb82aa3174
113 character_5eeae18f-5919-48e5-a8ef-c337875cfe7b
114 character_edb81c72-967e-4f8d-af8f-974bb6811e3e
115 character_9289164c-e974-4c5e-ac58-687af663764e</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  t296dba9d-b9b0-46bd-a339-94aaef32f544
2  t296dba9d-b9b0-46bd-a339-94aaef32f544
3  t296dba9d-b9b0-46bd-a339-94aaef32f544
4  t296dba9d-b9b0-46bd-a339-94aaef32f544
5  t296dba9d-b9b0-46bd-a339-94aaef32f544
6  t296dba9d-b9b0-46bd-a339-94aaef32f544
7  t296dba9d-b9b0-46bd-a339-94aaef32f544
8  t296dba9d-b9b0-46bd-a339-94aaef32f544
9  t296dba9d-b9b0-46bd-a339-94aaef32f544
10 t296dba9d-b9b0-46bd-a339-94aaef32f544
11 t296dba9d-b9b0-46bd-a339-94aaef32f544
12 t296dba9d-b9b0-46bd-a339-94aaef32f544
13 t296dba9d-b9b0-46bd-a339-94aaef32f544
14 t296dba9d-b9b0-46bd-a339-94aaef32f544
15 t296dba9d-b9b0-46bd-a339-94aaef32f544
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 t296dba9d-b9b0-46bd-a339-94aaef32f544
9   Ictalurus balsanus VTO_0036221 t296dba9d-b9b0-46bd-a339-94aaef32f544
10   Ictalurus dugesii VTO_0061497 t296dba9d-b9b0-46bd-a339-94aaef32f544
11  Ictalurus furcatus VTO_0036223 t296dba9d-b9b0-46bd-a339-94aaef32f544
12     Ictalurus lupus VTO_0036220 t296dba9d-b9b0-46bd-a339-94aaef32f544
13 Ictalurus mexicanus VTO_0061498 t296dba9d-b9b0-46bd-a339-94aaef32f544
14    Ictalurus pricei VTO_0036218 t296dba9d-b9b0-46bd-a339-94aaef32f544
15 Ictalurus punctatus VTO_0036225 t296dba9d-b9b0-46bd-a339-94aaef32f544
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label common_name
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus        &lt;NA&gt;</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>Fisherichthys 
         TRUE </code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the default build_opts will skip building the vignettes.</span>
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"phenoscape/rphenoscape"</span>, <span class="dt">build_opts=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-manual"</span>))</code></pre></div>
<p>The custom <code>build_opts</code> parameter ensures that the vignette(s) (such as this document) will be built and installed as well. (The default for <code>build_opts</code> will skip building vignettes.) Building vignettes requires a recent version of the knitr and rmarkdown packages. You can install these beforehand, or include the parameter <code>dependencies=TRUE</code> in the above. Note that the latter will also result in packages being installed that otherwise are only needed for <em>testing</em>, and for generating the help pages. If you don’t develop packages yourself, this may be much more than you need, and therefore installing knitr and rmarkdown beforehand is then the better option.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta7745e37-ea57-4285-9b13-35b497945931
2  ta7745e37-ea57-4285-9b13-35b497945931
3  ta7745e37-ea57-4285-9b13-35b497945931
4  ta7745e37-ea57-4285-9b13-35b497945931
5  ta7745e37-ea57-4285-9b13-35b497945931
6  ta7745e37-ea57-4285-9b13-35b497945931
7  ta7745e37-ea57-4285-9b13-35b497945931
8  ta7745e37-ea57-4285-9b13-35b497945931
9  ta7745e37-ea57-4285-9b13-35b497945931
10 ta7745e37-ea57-4285-9b13-35b497945931
11 ta7745e37-ea57-4285-9b13-35b497945931
12 ta7745e37-ea57-4285-9b13-35b497945931
13 ta7745e37-ea57-4285-9b13-35b497945931
14 ta7745e37-ea57-4285-9b13-35b497945931
15 ta7745e37-ea57-4285-9b13-35b497945931
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 ta7745e37-ea57-4285-9b13-35b497945931
2  VTO_0036220 ta7745e37-ea57-4285-9b13-35b497945931
3  VTO_0036275 ta7745e37-ea57-4285-9b13-35b497945931
4  VTO_0036276 ta7745e37-ea57-4285-9b13-35b497945931
5  VTO_0036278 ta7745e37-ea57-4285-9b13-35b497945931
6  VTO_0061495 ta7745e37-ea57-4285-9b13-35b497945931
7  VTO_0036218 ta7745e37-ea57-4285-9b13-35b497945931
8  VTO_0036225 ta7745e37-ea57-4285-9b13-35b497945931
9  VTO_0036277 ta7745e37-ea57-4285-9b13-35b497945931
10 VTO_0036272 ta7745e37-ea57-4285-9b13-35b497945931
11 VTO_0036274 ta7745e37-ea57-4285-9b13-35b497945931
12 VTO_0036223 ta7745e37-ea57-4285-9b13-35b497945931
13 VTO_0036273 ta7745e37-ea57-4285-9b13-35b497945931
14 VTO_0036221 ta7745e37-ea57-4285-9b13-35b497945931
15 VTO_0061497 ta7745e37-ea57-4285-9b13-35b497945931

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Pylodictis olivaris, Ictalurus dugesii, Ameiurus platycephalus, Ameiurus catus, Ictalurus punctatus, Ameiurus natalis ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_3d6745e9-2a6c-43ef-989b-c1ead7e74bd9
2     Ameiurus catus otu_bc887c44-4cc8-4fb8-b38f-a08db60de423
3     Ameiurus melas otu_8363840d-4353-44a9-a1a7-0fb8d70cc304
4   Ameiurus natalis otu_367f2de8-2efd-4583-8f9f-1170c8182951
5 Ameiurus nebulosus otu_b49cc4d2-ce3c-483b-bf3e-3e65bb1a241b
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1      Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
2        Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
3   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
4           Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
5      Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
6         Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
7           Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
8         Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
9      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
10      Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
11 Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
12        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
13        Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
14          Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
15      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
16       Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
17  Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
18         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
19   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
20      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
21     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
22       Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
                                        otu
1  otu_28b1ab09-56aa-46af-8589-3417d49cdbcc
2  otu_50cc6c58-1878-41a2-a138-330545d8747e
3  otu_43e87fbf-f5a4-46b6-8b56-27f7459e7c38
4  otu_bc887c44-4cc8-4fb8-b38f-a08db60de423
5  otu_74019618-e342-4f0b-ab53-3265ea249a2c
6  otu_367f2de8-2efd-4583-8f9f-1170c8182951
7  otu_8363840d-4353-44a9-a1a7-0fb8d70cc304
8  otu_ca360fa7-29c9-454f-b927-c02a574c2827
9  otu_63b6f5a8-6d8a-4b1e-935c-1d1dce51a52d
10 otu_af4f3668-ae4c-4a81-89b5-e7b8e0e48a3d
11 otu_1c843d25-c9c6-41ac-a464-28dec48056d6
12 otu_d2739b37-cf0c-4734-9f72-a8a071041382
13 otu_87d87085-c168-47e3-8a22-3e7100dcdcaf
14 otu_d82e9850-77b5-4abc-9627-94c0009fba4c
15 otu_b49cc4d2-ce3c-483b-bf3e-3e65bb1a241b
16 otu_3d6745e9-2a6c-43ef-989b-c1ead7e74bd9
17 otu_7ca26672-3da2-4ce5-ad88-9bacc7d5f832
18 otu_9816583d-afca-4ef4-8c17-2fe472cafccf
19 otu_6257f11f-2a38-457c-b44f-619482f93e9f
20 otu_0849132c-907c-453e-b4c5-dc58eccca415
21 otu_7da0f530-6857-4bfd-b187-68e60e2c849a
22 otu_2cff16c3-6b9c-4973-94f0-4e624721db02
                                        otus
1  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
2  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
3  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
4  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
5  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
6  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
7  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
8  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
9  otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
10 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
11 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
12 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
13 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
14 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
15 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
16 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
17 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
18 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
19 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
20 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
21 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f
22 otus_e8d36d7a-fc6f-4577-b41e-8fa17b2f163f

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_34ce59c5-031e-4e1e-99ce-618b35e40231
2   character_4e45dbac-09ce-4741-9fc9-e2c40f078cd1
3   character_8a00cf7c-82c1-4069-ba11-e0f60d2ee5db
4   character_329dc9fe-be28-4303-bd6d-12c9a03f5605
5   character_5cc65925-4419-41a8-bda0-831132759db3
6   character_0326d925-5596-4cc6-a59e-18aeb717749e
7   character_5a7a0273-bb66-4a41-a841-3a431ea20d0c
8   character_2ee46490-bdce-43d7-b707-498b1e69f4a5
9   character_68069489-a0e6-484c-8b2c-a92f163a8fa7
10  character_bfe379e9-0078-4b1f-ba22-1d70d3fb67b1
11  character_6e60ce12-683c-4a72-9732-bfd742256f25
12  character_452358dc-ecdd-4e29-83aa-0325e5a4e7b6
13  character_174e1770-ced0-437c-96b2-5dc2e48f6c3d
14  character_5ec9ec9e-2bc0-4a4a-852e-9226b6ff95fd
15  character_48ce7fec-e411-491d-a9b7-42640b9b9c4b
16  character_14eec96b-a677-49e7-97f7-c2179f281db9
17  character_58fb082e-df56-4e3a-aed8-59e8c8ecfb5c
18  character_bbbd603b-fc1c-4f40-927b-7ab590fce279
19  character_09861250-279c-4e2b-9bbd-5d6a8cfffdb0
20  character_d9055797-aacb-4f68-afe6-b3aa396066db
21  character_89f2240e-5e9b-411d-8785-0faf66bd42ee
22  character_96967f0a-da31-4017-a8a8-eae9cd1f7864
23  character_b6854b75-0325-4ab3-990a-13d9e217812c
24  character_f93d4385-08a1-4144-b43e-fb12e83104c2
25  character_65fbb4db-3f10-4853-9382-f857c791abfe
26  character_c6412343-9a8f-43c4-a1c1-b1eab06812ab
27  character_de703957-933a-424b-ae7a-dee5fd6c055e
28  character_8dbc4a25-2ec4-4ce4-9217-0ad0c5953bfa
29  character_2ca2cdfd-83ee-42cb-b460-1cecc7cf03d0
30  character_2b0f4bd3-80ba-44e4-8950-bb21c35092e8
31  character_234f87e7-feb8-4497-915a-4fa5e003a33e
32  character_5def2e62-6046-460e-9651-9b5e23cdd641
33  character_7bd715d3-7918-4e0e-8b40-9986040ec053
34  character_94893ade-a75f-4851-b252-535cc0fe3cd8
35  character_f1ac85ad-679e-4134-9cf7-4c4cbf45d2aa
36  character_8a5f3068-44e8-4ab2-bef8-1de8088e388c
37  character_ca42d3c6-85ec-4cfd-bcaf-f2670ef56bdd
38  character_0e9d6cbb-47a4-4737-ba4c-af2598840dbd
39  character_5507831d-7bbf-4cca-8a1f-0ea547cedd7f
40  character_6a92071a-bad1-4065-b9b9-f01074e68c87
41  character_e8ccaef7-765c-42c7-90a9-b29fc736ef9a
42  character_11f4c418-9e61-4da1-a5af-fe67394ce75b
43  character_2a0eec32-02d9-414a-80c1-7b33c9bc0146
44  character_96551eff-6d01-4773-b83a-e600574ae3bf
45  character_f7e2a383-9070-4db2-b3b1-f4e2586340d8
46  character_a7cef4ab-a88d-4f6c-ae57-32e78e233155
47  character_60913a56-341c-4dde-a45b-d7bdb70f8739
48  character_d48ca6bd-31ed-4688-8218-ece5c9174270
49  character_98136ce3-32a0-4669-9d3e-0475ab084e37
50  character_ef35e21a-59ec-4ff4-af2b-f0aa809e5da6
51  character_789901bc-aaac-4998-b438-7bac9e0ab507
52  character_02b4abf1-9e68-41e4-ae0c-b9693b1a2f41
53  character_f77e7eb2-72b8-4bf8-8a9a-c15d74c1c019
54  character_2f5fbd44-af17-4475-8712-ec151bb27943
55  character_783ff390-0687-478f-8f7a-de0e2baa3e72
56  character_86fbdb3e-8837-47b2-b980-e11e7b7b89cc
57  character_755473e0-bb2f-4d14-9fed-5d1fd4ca29b5
58  character_71febae5-13c0-4eb5-ba11-99b861ce57bb
59  character_4bee6486-5f39-4150-8062-4266b2661499
60  character_bd246a3c-48ce-47fc-bf4a-2981f9c2154b
61  character_abcb3218-ddf5-4080-9dc6-0689428b41e1
62  character_3a447bd2-10cb-41a9-ad67-6190a2bb0699
63  character_cffb1c4d-0178-4265-90c4-1a604d1f0fc9
64  character_505e0bff-e65e-4e3b-af32-3d0a9519d058
65  character_7136cdab-09b9-4341-9892-8233362df0df
66  character_20218a3d-5718-403d-869f-943c5eb16ffa
67  character_7a3e5790-8967-40d8-a3c3-2b5f73d7fd23
68  character_2c23856e-ec5c-4ffb-add7-c0926491ce82
69  character_df569fd1-34da-4cde-b835-4d6dfeca3a8e
70  character_828320b8-b230-4bc9-b5c4-e68d7f175f46
71  character_0cc38f75-dc50-4077-9077-712520eff652
72  character_9b2afe6c-d6f7-476f-a254-4bbe65b68f67
73  character_a013cbd9-55a5-41b2-ab27-a4b47ccb6425
74  character_d65af50d-8ad7-4657-afa1-98894e5e6729
75  character_cc386c56-dde9-4529-9137-b40d4957ec63
76  character_d9facbe2-a317-40e5-9d8f-f9dcf4c1a805
77  character_494fbc99-1399-4c02-8854-17eaaca98800
78  character_90c3a0f3-8380-4c04-8b08-8ed034308401
79  character_a0a1b706-59f7-481d-a1b2-49865a3ec788
80  character_3009e828-b70e-4859-84fd-68e1eb69a396
81  character_7ae8fac2-02d5-471f-8de5-e849c61817dc
82  character_00dc5a68-d416-4894-9d08-a2fd5d64db6b
83  character_690cd832-83f0-4240-9ec6-717608da3d95
84  character_d98036f6-20d1-4fd8-9788-161473742716
85  character_43b37482-d82d-4283-bcf6-0a0a5ff51098
86  character_fbf291b5-5862-4789-b868-29da7080a9b5
87  character_3a93765f-7ed0-4fd1-827a-b9834d9db295
88  character_0d79a630-ce5d-4f01-a4bf-7d148b353a96
89  character_637d2cb8-a9ac-46bc-a9ea-edc4f050d05a
90  character_3f93bd54-b338-46bb-b056-3375da1245ad
91  character_c9fdcc99-5efc-41c6-92e7-7351c230e7d8
92  character_461f1870-7386-4352-9339-1bd5ae87988a
93  character_d75aaf60-6cd2-4380-800e-c1246d521e1b
94  character_5428a36a-d19d-4546-b684-1c25507af6cf
95  character_a5f133a0-7ef0-4879-b54b-58b8ade09c88
96  character_27d0a2f1-3252-4afa-9c22-369f28e5f9e3
97  character_e0472536-386b-4262-ad4a-de3a6bf1f733
98  character_c6c99921-1958-49c4-a2db-40ec74e9b5b1
99  character_80faacbe-67f4-430e-8a57-479abcf2a467
100 character_39013eea-6df8-447e-91a5-c6e4f01a1075
101 character_21507172-7f91-4663-ade0-59829a4a3d76
102 character_1cbd9f94-f6b5-4b94-a9da-56f785b2cb9f
103 character_02d151d1-4125-4b1b-b982-4fded2ba6791
104 character_9b1f2270-a73f-4666-9e1b-9101d94b7989
105 character_e4d41072-1f30-45d4-9d87-0040bf0f5591
106 character_82946551-1b9e-4b92-9537-fa492b2e8f37
107 character_d075d477-812f-487e-ba1d-cb4acba9bd7b
108 character_4fe29ad5-c551-416d-b77c-0f1236aa0bfe
109 character_3a47a211-7dde-4f3f-8905-4c6f309c7ad6
110 character_426908a9-fa8d-494d-a123-07ba2582410d
111 character_3ce00b0a-6670-46b7-9648-40c966ad22d1
112 character_c39b7ac6-e653-4f25-99d4-a58fd537b9ab
113 character_a6898275-9f41-4ac5-9b08-30224c004eda
114 character_ab2a2860-8f8f-4af6-8222-d0ac99d2e515
115 character_dbe2c35f-3e72-4f83-84b4-badb6fffa925</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta7745e37-ea57-4285-9b13-35b497945931
2  ta7745e37-ea57-4285-9b13-35b497945931
3  ta7745e37-ea57-4285-9b13-35b497945931
4  ta7745e37-ea57-4285-9b13-35b497945931
5  ta7745e37-ea57-4285-9b13-35b497945931
6  ta7745e37-ea57-4285-9b13-35b497945931
7  ta7745e37-ea57-4285-9b13-35b497945931
8  ta7745e37-ea57-4285-9b13-35b497945931
9  ta7745e37-ea57-4285-9b13-35b497945931
10 ta7745e37-ea57-4285-9b13-35b497945931
11 ta7745e37-ea57-4285-9b13-35b497945931
12 ta7745e37-ea57-4285-9b13-35b497945931
13 ta7745e37-ea57-4285-9b13-35b497945931
14 ta7745e37-ea57-4285-9b13-35b497945931
15 ta7745e37-ea57-4285-9b13-35b497945931
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 ta7745e37-ea57-4285-9b13-35b497945931
9   Ictalurus balsanus VTO_0036221 ta7745e37-ea57-4285-9b13-35b497945931
10   Ictalurus dugesii VTO_0061497 ta7745e37-ea57-4285-9b13-35b497945931
11  Ictalurus furcatus VTO_0036223 ta7745e37-ea57-4285-9b13-35b497945931
12     Ictalurus lupus VTO_0036220 ta7745e37-ea57-4285-9b13-35b497945931
13 Ictalurus mexicanus VTO_0061498 ta7745e37-ea57-4285-9b13-35b497945931
14    Ictalurus pricei VTO_0036218 ta7745e37-ea57-4285-9b13-35b497945931
15 Ictalurus punctatus VTO_0036225 ta7745e37-ea57-4285-9b13-35b497945931
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>extinct 
   TRUE 
Levels: TRUE</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

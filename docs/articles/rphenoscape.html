<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPhenoscape Intro • rphenoscape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RPhenoscape Intro">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenoscape/rphenoscape">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>RPhenoscape Intro</h1>
                        <h4 class="author">Hong Xu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/master/vignettes/rphenoscape.Rmd"><code>vignettes/rphenoscape.Rmd</code></a></small>
      <div class="hidden name"><code>rphenoscape.Rmd</code></div>

    </div>

    
    
<p>Most of the services provided with the <a href="http://kb.phenoscape.org/apidocs/">Phenoscape Knowledgebase web API</a> return data in JSON format, plain text (usually tab-delimited), and NeXML. This package facilitates interfacing with the Phenoscape Knowledgebase for searching ontology terms, retrieving term info, and querying data matrices.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version of RPhenoscape is available on <a href="http://www.github.com/phenoscape/rphenoscape">Github</a>. It has not yet been released to [CRAN]. To install RPhenoscape from Github, use the <code>install_github()</code> function in the <code>remotes</code> package (which can be installed from CRAN using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages()</a></code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the default build_opts will skip building the vignettes.</span>
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"phenoscape/rphenoscape"</span>, <span class="dt">build_opts=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-manual"</span>))</code></pre></div>
<p>The custom <code>build_opts</code> parameter ensures that the vignette(s) (such as this document) will be built and installed as well. (The default for <code>build_opts</code> will skip building vignettes.) Building vignettes requires a recent version of the knitr and rmarkdown packages. You can install these beforehand, or include the parameter <code>dependencies=TRUE</code> in the above. Note that the latter will also result in packages being installed that otherwise are only needed for <em>testing</em>, and for generating the help pages. If you don’t develop packages yourself, this may be much more than you need, and therefore installing knitr and rmarkdown beforehand is then the better option.</p>
<p>Once installed, the package can be loaded (“attached”) as any other R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rphenoscape)</code></pre></div>
</div>
<div id="character-matrix-via-ontotrace" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrix-via-ontotrace" class="anchor"></a>Character Matrix via OntoTrace</h2>
<p>Use OntoTrace to obtain a character matrix for a taxonomic clade and anatomical region of interest.</p>
<p>The <a href="http://kb.phenoscape.org/apidocs/#/OntoTrace/get_ontotrace">Phenoscape Knowledgebase web API</a> returns the evolutionary character matrix in NeXML format. The first step is to get the NeXML object using <code>pk_get_ontotrace_xml</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_ontotrace_xml.html">pk_get_ontotrace_xml</a></span>(<span class="dt">taxon =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span>), <span class="dt">entity =</span> <span class="st">"fin spine"</span>)</code></pre></div>
<p>The result is an object of class <code>nexml</code> defined in the RNeXML package. The object mirrors the structure of a NeXML file, and can be inspected accordingly. Note that although generically NeXML files can contain multiple OTUs blocks and multiple characters blocks, NeXML files generated by the KB’s OntoTrace API contain only one. This means we can, for example, inspect the number of taxa and characters as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of taxa in the first (and only) OTUs block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>otus[[<span class="dv">1</span>]]<span class="op">@</span>otu)</code></pre></div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of characters in the first (and only) characters block</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(nex<span class="op">@</span>characters[[<span class="dv">1</span>]]<span class="op">@</span>format<span class="op">@</span>char)</code></pre></div>
<pre><code>[1] 2</code></pre>
<p>More details on the <a href="http://ropensci.github.io/RNeXML/reference/nexml-class.html"><code>nexml</code> object</a> can be found in the <a href="http://ropensci.github.io/RNeXML/">RNeXML documentation</a>.</p>
<p>Then retrieve wanted information from the NeXML object.<br>
Get character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace</a></span>(nex))</code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta65e21df-c5f4-442a-a3cc-238b38317549
2  ta65e21df-c5f4-442a-a3cc-238b38317549
3  ta65e21df-c5f4-442a-a3cc-238b38317549
4  ta65e21df-c5f4-442a-a3cc-238b38317549
5  ta65e21df-c5f4-442a-a3cc-238b38317549
6  ta65e21df-c5f4-442a-a3cc-238b38317549
7  ta65e21df-c5f4-442a-a3cc-238b38317549
8  ta65e21df-c5f4-442a-a3cc-238b38317549
9  ta65e21df-c5f4-442a-a3cc-238b38317549
10 ta65e21df-c5f4-442a-a3cc-238b38317549
11 ta65e21df-c5f4-442a-a3cc-238b38317549
12 ta65e21df-c5f4-442a-a3cc-238b38317549
13 ta65e21df-c5f4-442a-a3cc-238b38317549
14 ta65e21df-c5f4-442a-a3cc-238b38317549
15 ta65e21df-c5f4-442a-a3cc-238b38317549
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<p>The character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_ontotrace.html">pk_get_ontotrace_meta</a></span>(nex))</code></pre></div>
<pre><code>$id_taxa
                    label                                       href
1     Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
2         Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
3          Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4  Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
5      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
6     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
7        Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
8     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
9   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
10         Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
11       Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
12     Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13      Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
14     Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
15      Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
           otu                                  otus
1  VTO_0061498 ta65e21df-c5f4-442a-a3cc-238b38317549
2  VTO_0036220 ta65e21df-c5f4-442a-a3cc-238b38317549
3  VTO_0036275 ta65e21df-c5f4-442a-a3cc-238b38317549
4  VTO_0036276 ta65e21df-c5f4-442a-a3cc-238b38317549
5  VTO_0036278 ta65e21df-c5f4-442a-a3cc-238b38317549
6  VTO_0061495 ta65e21df-c5f4-442a-a3cc-238b38317549
7  VTO_0036218 ta65e21df-c5f4-442a-a3cc-238b38317549
8  VTO_0036225 ta65e21df-c5f4-442a-a3cc-238b38317549
9  VTO_0036277 ta65e21df-c5f4-442a-a3cc-238b38317549
10 VTO_0036272 ta65e21df-c5f4-442a-a3cc-238b38317549
11 VTO_0036274 ta65e21df-c5f4-442a-a3cc-238b38317549
12 VTO_0036223 ta65e21df-c5f4-442a-a3cc-238b38317549
13 VTO_0036273 ta65e21df-c5f4-442a-a3cc-238b38317549
14 VTO_0036221 ta65e21df-c5f4-442a-a3cc-238b38317549
15 VTO_0061497 ta65e21df-c5f4-442a-a3cc-238b38317549

$id_entities
                                            label
1 anterior distal serration of pectoral fin spine
2        anterior dentation of pectoral fin spine
                                           href           char
1 http://purl.obolibrary.org/obo/UBERON_2002002 UBERON_2002002
2 http://purl.obolibrary.org/obo/UBERON_2002001 UBERON_2002001</code></pre>
</div>
<div id="character-matrices-for-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#character-matrices-for-studies" class="anchor"></a>Character Matrices for Studies</h2>
<p>To obtain the character matrices for studies published for a taxonomic clade and anatomical region of interest.</p>
<p>First step is to retrieve the list of studies given a taxonomic clade and anatomical structures (returned as <code>data.frame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(slist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_list.html">pk_get_study_list</a></span>(<span class="dt">taxon =</span> <span class="st">"Ictalurus australis"</span>, <span class="dt">entity =</span> <span class="st">"fin"</span>))</code></pre></div>
<pre><code>                                                                                                                                 id
1 https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42
            label
1 Lundberg (1992)</code></pre>
<p>Based off the study ids retained from previous step, get the evolutionary character matrix for each study id (in NeXML-format) using <code>pk_get_study_xml</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nex_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_xml.html">pk_get_study_xml</a></span>(slist<span class="op">$</span>id))</code></pre></div>
<pre><code>$`https://scholar.google.com/scholar?q=The+Phylogeny+of+Ictalurid+Catfishes%3A+A+Synthesis+of+Recent+Work&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C42`
A nexml object representing:
     0 phylogenetic tree block(s),  
     1 character block(s), where:
       block 1 defines 115 standard/discrete character(s), with 2 to 7 states 
        and  0 polymorphic or uncertain state(s) defined 
       matrix 1 has 22 row(s) 
     22 taxonomic units in 1 block(s) 
  Taxa:  Ictalurus lupus, Noturus stigmosus, Ameiurus catus, Noturus flavus, Noturus insignis, Ictalurus pricei ...
  Metadata annotations: 
    3 at top level 
    22 in block 1 at otu level 
    0 in block 1 at char level 
    367 in block 1 at state level

NeXML generated by RNeXML using schema version: 0.9 
Size: 6.6 Mb </code></pre>
<p>From the list of NeXML objects, retrieve the character matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_matrix &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study.html">pk_get_study</a></span>(nex_list)
study_matrix[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>                taxa                                      otu
1  Ameiurus brunneus otu_cddd2120-a788-420f-ba9f-bc1671ba5e0f
2     Ameiurus catus otu_56d6932d-2f69-493d-8757-beef551b0a1c
3     Ameiurus melas otu_f35333eb-403a-4792-be16-ef381cf41c51
4   Ameiurus natalis otu_2a349edc-3bef-481e-acc9-0245f47d5905
5 Ameiurus nebulosus otu_5e6bdecf-8a46-46bc-bde9-f15ab76c4020
  Anal-fin rays, species mean count Anterior dentations of pectoral spine
1                           16.1-20                                 large
2                         20.1-25.5                              moderate
3                         20.1-25.5                                 small
4                           25.6-28                                 small
5                         20.1-25.5                              moderate
  Anterior distal serrae of pectoral spine
1               &lt;3 moderately sharp serrae
2              3-6 moderately sharp serrae
3             absent or scarcely developed
4              3-6 moderately sharp serrae
5               &lt;3 moderately sharp serrae</code></pre>
<p>Each character matrix can be integrated with other data, such as meta data which include taxon identifiers, character identifiers, etc. Get meta data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study_metas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_get_study_meta.html">pk_get_study_meta</a></span>(nex_list)
study_metas[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>$id_taxa
                     label                                       href
1          Ictalurus lupus http://purl.obolibrary.org/obo/VTO_0036220
2        Noturus stigmosus http://purl.obolibrary.org/obo/VTO_0036261
3           Ameiurus catus http://purl.obolibrary.org/obo/VTO_0036275
4           Noturus flavus http://purl.obolibrary.org/obo/VTO_0036263
5         Noturus insignis http://purl.obolibrary.org/obo/VTO_0036237
6         Ictalurus pricei http://purl.obolibrary.org/obo/VTO_0036218
7      Ictalurus mexicanus http://purl.obolibrary.org/obo/VTO_0061498
8         Ameiurus natalis http://purl.obolibrary.org/obo/VTO_0036274
9   Ameiurus platycephalus http://purl.obolibrary.org/obo/VTO_0036276
10      Ictalurus balsanus http://purl.obolibrary.org/obo/VTO_0036221
11     Pylodictis olivaris http://purl.obolibrary.org/obo/VTO_0036282
12      Ictalurus furcatus http://purl.obolibrary.org/obo/VTO_0036223
13     Ictalurus australis http://purl.obolibrary.org/obo/VTO_0061495
14      Ameiurus nebulosus http://purl.obolibrary.org/obo/VTO_0036278
15   Ameiurus serracanthus http://purl.obolibrary.org/obo/VTO_0036277
16 Trogloglanis pattersoni http://purl.obolibrary.org/obo/VTO_0061501
17        Satan eurystomus http://purl.obolibrary.org/obo/VTO_0061485
18  Prietella phreatophila http://purl.obolibrary.org/obo/VTO_0036265
19     Ictalurus punctatus http://purl.obolibrary.org/obo/VTO_0036225
20       Ictalurus dugesii http://purl.obolibrary.org/obo/VTO_0061497
21       Ameiurus brunneus http://purl.obolibrary.org/obo/VTO_0036273
22          Ameiurus melas http://purl.obolibrary.org/obo/VTO_0036272
                                        otu
1  otu_7725d557-1f49-4d1f-8a29-576961b5ef15
2  otu_5defe619-7e5a-4727-b3d5-b5bbace92a66
3  otu_56d6932d-2f69-493d-8757-beef551b0a1c
4  otu_fe96d043-8df0-47db-98d5-4996b58106fa
5  otu_ac653ab0-e25f-4dd0-92b4-f66c8ce12c03
6  otu_c30b8e54-2660-494f-afde-b0b223205a02
7  otu_4714a5fd-80b6-45b8-b836-0699b92d8ffa
8  otu_2a349edc-3bef-481e-acc9-0245f47d5905
9  otu_e4e9b7dd-c687-4f86-a7c8-dd23e71f79a0
10 otu_2ae25b8b-63ad-4e25-889c-a5c3b9cdca32
11 otu_b19860d4-4d29-4911-8356-83abdcc63f2e
12 otu_e3e5141c-ea3a-406b-8ce7-49b24028b8da
13 otu_deb5cf2a-6eb3-4547-acff-5d47b6ab8b76
14 otu_5e6bdecf-8a46-46bc-bde9-f15ab76c4020
15 otu_99703978-ff45-4515-84f5-a1a0fe97f9c1
16 otu_e2b6c8a3-fe1c-429e-9b9e-fed1e1e54438
17 otu_8580e9b3-a3a7-4501-bc16-de5eeba5b2a1
18 otu_cc88b2f1-7ce6-42f0-9a34-7274f8b9d3ed
19 otu_5fd58032-2d36-449b-8198-e0297e40eded
20 otu_b8e26d9f-28ca-48e4-845e-ab335ab59555
21 otu_cddd2120-a788-420f-ba9f-bc1671ba5e0f
22 otu_f35333eb-403a-4792-be16-ef381cf41c51
                                        otus
1  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
2  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
3  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
4  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
5  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
6  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
7  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
8  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
9  otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
10 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
11 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
12 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
13 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
14 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
15 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
16 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
17 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
18 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
19 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
20 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
21 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9
22 otus_d44a7f57-c904-4a15-a18c-4ce85c6282f9

$id_entities
                                                              label
1                                     Posterior flap of adipose fin
2                                                    Gill membranes
3                                                       Orbital rim
4                                                        Caudal fin
5                                               Lateral line extent
6                                                 Mesethmoid cornua
7                           Width of snout across mesethmoid cornua
8                                          Width of mesethmoid neck
9        Cross-sectional form of skull (juveniles and young adults)
10                             Neurocranial width at epiphyseal bar
11                            Posterior cranial fontanelle (adults)
12                Supraoccipital process and associated supraneural
13                                    Sagittal crests on skull roof
14                                      Transverse occipital crests
15                               Muscle crests on margin of frontal
16                     Sculpturing pattern of supraoccipital crests
17                                     Anterior extent of sphenotic
18                                                Sphenotic process
19                                   Extrascapular bone composition
20                                              Pterotic wing shape
21                                                 Pterotic surface
22                                                      Nasal shape
23                                               Infraorbital bones
24                                             Lateral ethmoid wing
25                             Superficial ophthalmic nerve foramen
26                                                  Orbital foramen
27                                                Parasphenoid stem
28                                  Ascending wings of parasphenoid
29    Posterior end of adductor arcus palatini scar on parasphenoid
30                                         Vertical wing of frontal
31                                      Pterosphenoid-prootic joint
32                                           Orbitosphenoid shelves
33                                        Prootic-exoccipital joint
34                                      Prootic-basioccipital joint
35                                                    Optic foramen
36                                                  Mandible length
37                    Mandibular sensory canal pores, species modes
38                           First mandibular sensory pore and tube
39                            Mandibular symphyseal ventral process
40                                   Anteroventral crest of dentary
41                                                 Coronoid process
42                                   Posterior process of articular
43                                                 Premaxilla width
44                                     Mesial process of premaxilla
45                                    Lateral process of premaxilla
46                               Premaxillary teeth-size and number
47                               Jaw teeth-shape and size gradation
48                                Jaw adductor musculature-A3 layer
49                                                  Palatine length
50                          Hyomandibular (otic region joint) shape
51                                Anterior process of hyomandibular
52      Opercular facet position on posterior edge of hyomandibular
53                                Hyomandibular-metapterygoid joint
54                                     Hyomandibular-quadrate joint
55  Scar on hyomandibular for A3 bundle of jaw adductor musculature
56         Crest on hyomandibular for levator arcus palatini muscle
57      Crest on hyomandibular for A2 bundle of jaw adductor muscle
58               Crest on hyomandibular for levator operculi muscle
59     Process on hyomandibular for adductor hyomandibularis muscle
60     External foramen of facial nerve canal through hyomandibular
61                                                 Symplectic canal
62             Jaw adductor muscle attachment surface on preopercle
63                                         Upper limb of preopercle
64                                                  Suprapreopercle
65                              Quadrate-metapterygoid joint length
66                         Quadrate-metapterygoid joint composition
67                                               Metapterygoid form
68                                               Endopterygoid size
69                                         Epihyal-ceratohyal joint
70                                        Dorsal edge of ceratohyal
71                                                    Epihyal shape
72                                Ceratohyal-ventral hypohyal joint
73                                                  Dorsal hypohyal
74                                                    Urohyal shape
75                                                    Opercle shape
76                      Scar on opercle for levator operculi muscle
77                                               Interopercle shape
78                                     Dorsal pits on first centrum
79                                  Ventral ridges on first centrum
80                          Development of superficial ossification
81                       Anterior limb of fourth transverse process
82           Vertical lamina between third and fourth neural spines
83                                   Neural complex = supraneural 3
84                                        Depth of Weberian complex
85                                                      Gas bladder
86                         Precaudal vertebrae, species mean number
87                            Caudal vertebrae, species mean number
88                                                         Hypurals
89                                                   Hypurapophysis
90                                  Caudal-fin branched ray numbers
91            Middle Nuchal plate of first dorsal-fin pterygiophore
92           Spine base condyles on second dorsal-fin pterygiophore
93                                     Dorsal-fin spine development
94                                Anal-fin rays, species mean count
95                      Pectoral-fin soft rays, species modal count
96                                             Pectoral-fin radials
97             Ornamentation pattern on posterior cleithral process
98                            Length of posterior cleithral process
99                                    Length of cleithral symphysis
100                    Coracoid midline sutures, species mean count
101                                        Ventral keel of coracoid
102               Secondary keel on coracoid below scapular foramen
103                               Extensor muscle fossa on coracoid
104                                           Transcapular ligament
105                           Subpterotic process of supracleithrum
106                                              Pectoral spine tip
107                        Anterior distal serrae of pectoral spine
108                           Anterior dentations of pectoral spine
109                                Anterior ridge of pectoral spine
110                                       Posterior dentation shape
111                                       Posterior dentation bases
112                                    Pectoral spine late ontogeny
113                         Posterolateral process of basipterygium
114                                                   Pelvic splint
115                           Pelvic-fin rays, species modal counts
                                              char
1   character_b9ded4a8-54a7-4b92-a307-ea1261722844
2   character_7dd8b428-39ea-42e3-9bc1-012990ce8da7
3   character_56342193-5a88-48f0-9696-b620298585a1
4   character_f3ba50f9-fbe4-419b-93e6-0edcabb92f77
5   character_b9e19a06-6046-424e-a096-d5054bffe142
6   character_8e19536a-bf19-490e-b219-eba0051c27d8
7   character_01214d76-95ec-4646-affc-df57f97cc2b6
8   character_7f9452c1-5032-4983-aaa4-a99324763f87
9   character_962a6184-1e1c-42ed-8e8f-8b2290a8e18e
10  character_37826f58-00cd-42a3-91d1-23d286547fe4
11  character_bbe0474f-2906-4bf3-99f8-7818418fc0d6
12  character_9e51fe7e-1191-4860-b44b-662682e19324
13  character_b0fca045-33c4-4667-8576-362046bd2577
14  character_ce9c39ec-342e-4828-92b1-467bc7f81ddb
15  character_4a024476-ec9d-4528-9fe2-1512738c477c
16  character_a73ff453-a4ff-4de1-9665-fba31683332c
17  character_37b68aeb-edd2-4d81-926a-0c3f005a7df4
18  character_ca7fe6b3-1961-4bf5-9e6b-7b9d32b7a3d0
19  character_a625203b-822a-4077-a5ba-9a234f2091f8
20  character_d5e9d098-d1a2-4216-b4ac-43709766c5c8
21  character_ba7a3396-41ed-477f-a104-3ff340920f96
22  character_adec8ac8-e555-4947-a891-504fc9d6456f
23  character_234087c4-babf-4661-9b22-5ccb33d72acd
24  character_188a0e01-fb7e-4770-b5cf-de751562a93e
25  character_94ed5c73-1fca-4902-a015-4c84916c7340
26  character_793dfb45-1948-45d8-a93a-9a977673ba9d
27  character_9891d815-d8a6-453a-b69e-247fc9aff32e
28  character_7c83b646-b860-46b1-b6e1-cf9228d48422
29  character_631c832b-a74a-4d16-af74-238c88dade4a
30  character_f2002eb2-7ede-42d5-8a87-7835e379d4fc
31  character_8a498243-57dc-4954-aff1-e0e477a6e44e
32  character_4e302bae-2879-433d-8c92-c9d30a4fe659
33  character_7e1bd2f4-a262-4053-9a2c-baa17b90f682
34  character_eaa59d0b-057f-49c8-aaa9-5cab428d978d
35  character_9bd18d17-1cbe-4656-aa62-f9ee25acc31f
36  character_81329203-93fc-47ca-a0bc-39c2d8b6e03e
37  character_1387df31-2d2d-460e-8f8e-fd85899d9cdf
38  character_d05f3b22-e5df-4242-979c-e58df43c9a55
39  character_523c12db-e63e-4950-b560-e94d4a48d1e8
40  character_982858a3-96b2-418c-9144-c7d7d6407656
41  character_416f42d7-2777-4272-a416-18bdc4dec0eb
42  character_295144fe-7223-4e48-a29e-71e09c186363
43  character_a2b79f68-a48b-4e15-94f3-dec8a3d8a40e
44  character_b8403b20-928d-4689-aa74-c270f3e771dd
45  character_d615b3a5-379e-4db7-8dc4-cfff5e6b84cc
46  character_6d138f0a-5663-4e7c-a094-c8188d4391b5
47  character_d46e157d-4f63-486c-92cc-38e4ab088707
48  character_9d14ea54-953d-4b85-9401-3280ee4bfaee
49  character_f6762faf-a52e-48b8-827b-297eeea9fadb
50  character_25fb5329-57c2-4bee-9e90-58e67d5f5ad9
51  character_982840d3-9ee9-450b-9e94-ea023dfdffd8
52  character_cf8e4411-bc89-48ff-be93-eac5860822d4
53  character_765d3f2a-8932-49c8-b801-9c476c7048c4
54  character_e22ff613-8378-47cc-9cca-d7c2e80c1ee5
55  character_0cad2c4a-0a3e-4c33-ac47-93882108a4a0
56  character_9f4029c5-701e-4aad-b938-2f38cb544bf8
57  character_fab78ab2-b8d3-4445-b487-54c348c80357
58  character_ac76bb5c-c73d-4115-b52f-fde8dc3b8440
59  character_39316992-5733-4836-9672-511e702f0a71
60  character_0c92a85e-25d9-4bb7-a357-e92cc2da9dd2
61  character_f03276e7-c203-49ac-aa17-cf742d8de533
62  character_3f1fd3ce-16c2-41fb-be29-2eb9192540cb
63  character_99964e1e-49f2-457b-8bbe-06d763cbd42a
64  character_0315674f-ac14-46c7-980f-5476e95f183b
65  character_7290d91f-8a1d-4901-aa06-54e2bcb208c4
66  character_d51ac8c5-5356-42af-a373-e3739d706388
67  character_bad28a8f-012d-403b-a33f-51667688ec96
68  character_cabae6ef-faa0-4169-89c8-2409b29e4daf
69  character_ac81110f-4cef-4d1b-82e7-463795afd204
70  character_e1f0daf0-4476-43a4-aa55-f41c4206cae6
71  character_d30b630a-57c7-4a61-b05f-5b625400edf9
72  character_0336141b-bdfd-4d43-b57b-6a0531bcdafc
73  character_b5d61644-84ae-45cb-9dc7-60e53bf295df
74  character_8636ae4a-c5aa-418c-b204-94b3b4b400ce
75  character_95f3bdf4-8097-40b2-9a48-38c39fe7d06e
76  character_a36f40a9-8922-4c0e-88cb-26db81ad9f4f
77  character_c893bcd1-036a-4963-85bd-6d8887d85b23
78  character_513512fd-f667-40c9-aa52-3aaeb04787d4
79  character_be1fdba2-4f8c-41ff-9543-a81bb568b888
80  character_6ff4bd20-1975-4add-ba58-cd50802c1922
81  character_d72ba4d6-9d08-4640-a25d-10c3d86fafc0
82  character_7931f24f-0019-4e8c-974f-f6b398a3dd96
83  character_f414fba0-ba3d-4451-bb41-d9a42ad159bf
84  character_8878bc31-86c6-4358-aa89-dbc16d7ca544
85  character_674142f2-d168-484e-960c-108c8bae4e80
86  character_eb35bfac-efd2-4527-926b-36c322b400cf
87  character_0bef7130-bece-4d5d-94e7-a6ee8f6b25ab
88  character_3815ab74-8328-419c-b921-1b136867ec25
89  character_d71dd1f4-072b-4c0a-9db7-4396122f6a55
90  character_366ddd53-2257-4eda-92a4-32f78cedafd5
91  character_a619c20c-ad2f-4db7-97a9-06cce1dfc1ac
92  character_f0fff0e9-4309-405f-a937-f2a6725cd61d
93  character_acae8dd1-23ac-4d0e-8461-c5d2a1c568ea
94  character_d40bba5d-3cf2-45d0-a8e0-9710af6b3d7f
95  character_0ab0cf2e-b616-41a4-b9d1-98e4cf826df4
96  character_b5c5dc23-5938-4a5b-a3c8-438432635b7a
97  character_00a46174-54c0-4e9c-8f76-384a58a7db35
98  character_8cbdeb1d-ede3-4635-a408-1a33983e0f9b
99  character_ec3f1f12-a065-41b5-b0a7-b80425de8475
100 character_1fabb86d-17f1-4e59-90fe-ce4ef4c70597
101 character_ab8c066b-9155-45e6-bb67-7e2f874ddb00
102 character_04516970-b79c-49a5-b463-17a28fa7b180
103 character_8e9340cf-3a5f-4209-886c-fa2d54d48e81
104 character_dc6c11eb-98d6-465d-a1e9-66214033c0c9
105 character_84bc413d-851a-4f27-b06e-5a782e603499
106 character_f8e78808-8309-4f78-bbea-15faab64c322
107 character_1a1ac467-a58c-4b7a-8d75-45ba9e9bd405
108 character_8c73de8d-2fa4-400f-95d3-3afdceee3f8f
109 character_a9ac1b8f-d71a-4522-8890-0b400a350892
110 character_df3c9a1b-8bfb-4fcc-8a61-7a7acbb1557b
111 character_c3e21db2-6c81-4d59-ab24-9586a928e84d
112 character_ec1e09f3-a452-434f-98b4-003d225d8554
113 character_669e69c8-4829-4de9-a958-62a4f7b046a6
114 character_b26eb782-6352-4ce8-9c56-adbf8eb41f26
115 character_e3597076-6f03-47af-8bb5-e28d3898f51b</code></pre>
</div>
<div id="obtain-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-other-data" class="anchor"></a>Obtain Other Data</h2>
<div id="subsetting-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-a-matrix" class="anchor"></a>Subsetting a Matrix</h3>
<p>A matrix obtained from Phenoscape can be subsetted (filtered) by taxonomic subgroup or anatomical part. For example, using <code>pk_is_descendant</code> and <code>pk_is_ancestor</code> methods, a matrix can be subsetted to a taxonomic subgroup that is the descendants/ancestors of a given taxon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m <span class="co"># original character matrix</span></code></pre></div>
<pre><code>                     taxa         otu
1       Ameiurus brunneus VTO_0036273
2          Ameiurus catus VTO_0036275
3          Ameiurus melas VTO_0036272
4        Ameiurus natalis VTO_0036274
5      Ameiurus nebulosus VTO_0036278
6  Ameiurus platycephalus VTO_0036276
7   Ameiurus serracanthus VTO_0036277
8     Ictalurus australis VTO_0061495
9      Ictalurus balsanus VTO_0036221
10      Ictalurus dugesii VTO_0061497
11     Ictalurus furcatus VTO_0036223
12        Ictalurus lupus VTO_0036220
13    Ictalurus mexicanus VTO_0061498
14       Ictalurus pricei VTO_0036218
15    Ictalurus punctatus VTO_0036225
                                    otus
1  ta65e21df-c5f4-442a-a3cc-238b38317549
2  ta65e21df-c5f4-442a-a3cc-238b38317549
3  ta65e21df-c5f4-442a-a3cc-238b38317549
4  ta65e21df-c5f4-442a-a3cc-238b38317549
5  ta65e21df-c5f4-442a-a3cc-238b38317549
6  ta65e21df-c5f4-442a-a3cc-238b38317549
7  ta65e21df-c5f4-442a-a3cc-238b38317549
8  ta65e21df-c5f4-442a-a3cc-238b38317549
9  ta65e21df-c5f4-442a-a3cc-238b38317549
10 ta65e21df-c5f4-442a-a3cc-238b38317549
11 ta65e21df-c5f4-442a-a3cc-238b38317549
12 ta65e21df-c5f4-442a-a3cc-238b38317549
13 ta65e21df-c5f4-442a-a3cc-238b38317549
14 ta65e21df-c5f4-442a-a3cc-238b38317549
15 ta65e21df-c5f4-442a-a3cc-238b38317549
   anterior dentation of pectoral fin spine
1                                         1
2                                         1
3                                        NA
4                                        NA
5                                         1
6                                         1
7                                         1
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
1                                                1
2                                                1
3                                          1 and 0
4                                                1
5                                                1
6                                                1
7                                                1
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(is_desc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pk_is_descendant.html">pk_is_descendant</a></span>(<span class="st">'Ictalurus'</span>, m<span class="op">$</span>taxa))</code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[12]  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m[is_desc, ] <span class="co">#subsetting to the descendants of Ictalurus</span></code></pre></div>
<pre><code>                  taxa         otu                                  otus
8  Ictalurus australis VTO_0061495 ta65e21df-c5f4-442a-a3cc-238b38317549
9   Ictalurus balsanus VTO_0036221 ta65e21df-c5f4-442a-a3cc-238b38317549
10   Ictalurus dugesii VTO_0061497 ta65e21df-c5f4-442a-a3cc-238b38317549
11  Ictalurus furcatus VTO_0036223 ta65e21df-c5f4-442a-a3cc-238b38317549
12     Ictalurus lupus VTO_0036220 ta65e21df-c5f4-442a-a3cc-238b38317549
13 Ictalurus mexicanus VTO_0061498 ta65e21df-c5f4-442a-a3cc-238b38317549
14    Ictalurus pricei VTO_0036218 ta65e21df-c5f4-442a-a3cc-238b38317549
15 Ictalurus punctatus VTO_0036225 ta65e21df-c5f4-442a-a3cc-238b38317549
   anterior dentation of pectoral fin spine
8                                         1
9                                         0
10                                       NA
11                                        0
12                                        1
13                                       NA
14                                        1
15                                        1
   anterior distal serration of pectoral fin spine
8                                                1
9                                          1 and 0
10                                               1
11                                               1
12                                               1
13                                               1
14                                               1
15                                               1</code></pre>
</div>
<div id="term-search" class="section level3">
<h3 class="hasAnchor">
<a href="#term-search" class="anchor"></a>Term Search</h3>
<p>Search for details for a given taxon:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_taxon_detail</a></span>(<span class="st">"Coralliozetus"</span>)</code></pre></div>
<pre><code>                                          id         label extinct
1 http://purl.obolibrary.org/obo/VTO_0042955 Coralliozetus   FALSE
                                         rank.id rank.label common_name
1 http://purl.obolibrary.org/obo/TAXRANK_0000005      genus        &lt;NA&gt;</code></pre>
<p>Search for details for a given anatomical structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_terms.html">pk_anatomical_detail</a></span>(<span class="st">"basihyal bone"</span>)</code></pre></div>
<pre><code>          label
1 basihyal bone
                                                                                definition
1 Replacement bone that is median and is the anterior-most bone of the ventral hyoid arch.
                                             id
1 http://purl.obolibrary.org/obo/UBERON_0011618</code></pre>
<div id="miscellaneous-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#miscellaneous-methods" class="anchor"></a>Miscellaneous methods:</h4>
<p>Resolve a given term to its IRI:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"Coralliozetus"</span>, <span class="st">"vto"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/VTO_0042955"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_get_iri.html">pk_get_iri</a></span>(<span class="st">"basihyal bone"</span>, <span class="st">"uberon"</span>)</code></pre></div>
<pre><code>[1] "http://purl.obolibrary.org/obo/UBERON_0011618"</code></pre>
<p>Test if a taxon is extinct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pk_is_extinct.html">pk_is_extinct</a></span>(<span class="st">"Fisherichthys"</span>)</code></pre></div>
<pre><code>Fisherichthys 
         TRUE </code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#character-matrix-via-ontotrace">Character Matrix via OntoTrace</a></li>
      <li><a href="#character-matrices-for-studies">Character Matrices for Studies</a></li>
      <li><a href="#obtain-other-data">Obtain Other Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
